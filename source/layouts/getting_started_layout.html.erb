<% html = yield %>

<% content_for :sidebar do %>
  <%= table_of_contents html, max_level: 2 %>
<% end %>

<% wrap_layout :layout_with_sidebar do %>
  <%= partial 'partials/header' %>

  <%= html %>

  <% if locals.key?(:page) %>
    <%= partial 'partials/source', page: page %>
  <% end %>
<% end %>
