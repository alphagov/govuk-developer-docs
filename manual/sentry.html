





<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Sentry - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/manual/sentry.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="Sentry - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/manual/sentry.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="Sentry" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/manual/sentry.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>We’d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/manual.html" aria-current="page">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/apps.html">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <a href='/manual.html' class="toc__back-link govuk-link">&lsaquo; Manual</a>
  <ul>
  <li>
    <a href="#header"><span>Sentry</span></a>
    <ul>
      <li>
        <a href="#getting-access-to-sentry"><span>Getting access to Sentry</span></a>
      </li>
      <li>
        <a href="#nomenclature"><span>Nomenclature</span></a>
      </li>
      <li>
        <a href="#how-gov-uk-projects-are-added-to-sentry"><span>How GOV.UK projects are added to Sentry</span></a>
      </li>
      <li>
        <a href="#how-sentry-is-integrated-on-gov-uk"><span>How Sentry is integrated on GOV.UK</span></a>
      </li>
      <li>
        <a href="#sentry-roles"><span>Sentry roles</span></a>
      </li>
      <li>
        <a href="#deciding-whether-to-log-errors-in-sentry"><span>Deciding whether to log errors in Sentry</span></a>
        <ul>
          <li>
            <a href="#ignoring-exception-types"><span>Ignoring exception types</span></a>
          </li>
          <li>
            <a href="#advanced-sentry-customisation"><span>Advanced Sentry customisation</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#when-errors-are-received-by-sentry"><span>When errors are received by Sentry</span></a>
        <ul>
          <li>
            <a href="#fingerprinting"><span>Fingerprinting</span></a>
          </li>
          <li>
            <a href="#rate-limiting"><span>Rate limiting</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#slack-alerts"><span>Slack alerts</span></a>
      </li>
      <li>
        <a href="#sentry-issue-actions"><span>Sentry issue actions</span></a>
        <ul>
          <li>
            <a href="#merging-sentry-issues"><span>Merging Sentry issues</span></a>
          </li>
          <li>
            <a href="#resolving-an-issue"><span>Resolving an issue</span></a>
          </li>
          <li>
            <a href="#archiving-or-ignoring-an-issue"><span>Archiving (or ignoring) an issue</span></a>
          </li>
          <li>
            <a href="#commenting-on-an-issue"><span>Commenting on an issue</span></a>
          </li>
          <li>
            <a href="#deleting-and-discarding-an-issue"><span>Deleting and discarding an issue</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#gds-wide-usage-of-sentry"><span>GDS-wide usage of Sentry</span></a>
      </li>
      <li>
        <a href="#retention-period"><span>Retention period</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
                
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Monitoring and alerting",
        "@id": "http://www.dev.gov.uk/manual.html#monitoring-and-alerting"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/manual.html#monitoring-and-alerting">Monitoring and alerting</a>
        </li>
  </ol>
</nav>
   <div class="govuk-!-font-size-16 govuk-!-margin-top-6">

  Last updated: <a href="https://github.com/alphagov/govuk-developer-docs/commit/dfd3f557db2acad5800ad12be7552b2c4d13ea88">23 Oct 2025</a>
</div>

 <h1 id='header'>Sentry</h1> <p><a href="https://sentry.io/govuk/">Sentry</a> is a service that collates errors that happen on GOV.UK in one
place, regardless of which application, what environment or what machine
the error occurred on. It is far more convenient than logging on to
individual machines and querying their logs.</p>
<p>Useful links:</p>

<ul>
<li><a href="https://sentry.io/organizations/govuk/stats/">Sentry Organization Stats</a>
for an overview of how many errors are being sent/rate-limited site-wide.</li>
<li><a href="https://sentry.io/organizations/govuk/projects/">Sentry Projects</a>
for a per-project view, enabling you to see which ones are causing the
most errors right now.</li>
</ul>
<h2 id='getting-access-to-sentry'>Getting access to Sentry</h2><p>Your tech lead should manually add you to Sentry via the Sentry UI. Access also has to be recorded in <a href="https://github.com/alphagov/govuk-user-reviewer?tab=readme-ov-file#adding-users">govuk-user-reviewer</a>.
Once you&rsquo;ve accept the invite, you&rsquo;ll be able to <a href="https://sentry.io/auth/login/">sign in</a> using your GDS Google account.
We have a single <code>#govuk-developers</code> team and <a href="https://github.com/alphagov/govuk-user-reviewer/issues/1306">additional teams should not be created in Sentry</a>.</p>
<h2 id='nomenclature'>Nomenclature</h2>
<ul>
<li><strong>Project</strong>: each GOV.UK application has its own project on Sentry, where
errors originating from that application are consolidated. Example:
<a href="https://sentry.io/organizations/govuk/issues/?project=202242">publishing-api</a></li>
<li><strong>Issue</strong>: a group of similar errors. For example, multiple instances of
<code>NoMethodError</code> from the same app are likely to be logged under the same
issue (see <a href="https://sentry.io/organizations/govuk/issues/2150349125/?project=202259&amp;query=is%3Aunresolved">example</a>) in the project in Sentry. In practice,
there are a <a href="#fingerprinting">variety of factors</a> that determine
whether errors are grouped under the same issue.</li>
<li><strong>Error/Exception</strong>: a single occurrence of an Issue, containing details
such as stack trace, arguments, server IP and error message.
See <a href="https://sentry.io/organizations/govuk/issues/2155210524/events/aa4edd05a94c4d14b07d4c754a13c788/">example</a>.</li>
</ul>
<h2 id='how-gov-uk-projects-are-added-to-sentry'>How GOV.UK projects are added to Sentry</h2><p>Projects can be created and edited in the Sentry UI, but this risks creating
inconsistencies or missing apps. We therefore configure projects using
Terraform.</p>
<p><a href="https://github.com/alphagov/govuk-infrastructure/blob/main/terraform/deployments/sentry/locals.tf">Projects are managed in govuk-infrastructure</a>. To create a new project, edit the respective terraform and run a
plan and apply of the project in Terraform Cloud.</p>
<h2 id='how-sentry-is-integrated-on-gov-uk'>How Sentry is integrated on GOV.UK</h2><p>Apps are configured to talk to Sentry using the <a href="https://github.com/alphagov/govuk_app_config">govuk_app_config</a> gem,
which interfaces with Sentry via its <a href="https://github.com/alphagov/govuk_app_config/blob/master/lib/govuk_app_config/govuk_error.rb"><code>GovukError</code> class</a>. Apps
call <code>GovukError.configure</code> - see <a href="https://github.com/alphagov/email-alert-api/blob/main/config/initializers/govuk_error.rb">example</a>. This
uses the <a href="https://github.com/alphagov/govuk_app_config/pull/160">delegator pattern</a> to proxy requests to the
underlying Sentry gem, which is <a href="https://github.com/getsentry/sentry-ruby/tree/master/sentry-raven">sentry-ruby</a> in govuk_app_config v4 and
above.</p>
<p>Unhandled exceptions are automatically logged to Sentry, but you can also
<a href="https://github.com/alphagov/govuk_app_config/blob/073c9b2312a4893b040c9225b713ac880c69f5b8/README.md#manual-error-reporting">manually report something to Sentry using <code>GovukError.notify</code></a>.
This method takes an exception object, or a string.</p>
<h2 id='sentry-roles'>Sentry roles</h2><p>There are different &lsquo;roles&rsquo; in Sentry, with different permissions:</p>

<ul>
<li>Most people with access to Sentry have the &ldquo;Member&rdquo; role, which lets them
view errors, issues and projects.</li>
<li>Those with the &ldquo;Admin&rdquo; role can configure teams and projects.</li>
<li>Those with the &ldquo;Manager&rdquo; role can edit organisation settings and set things
like global rate limits.</li>
<li>Those with the &ldquo;Owner&rdquo; role have unrestricted access to the system and can
make billing and plan changes.</li>
</ul>
<p>Some links in this documentation will only be visible to those with the
right permissions. If you need a higher permission than you already have, the
senior tech team can apply this for you.</p>
<h2 id='deciding-whether-to-log-errors-in-sentry'>Deciding whether to log errors in Sentry</h2><p>We should only capture actionable errors in Sentry, i.e. errors representing
an underlying issue that developers can fix. We should not capture 4XX
responses, for example, as these indicate a client issue. In fact, sentry-raven
ignores several exception types by default - see below.</p>
<h3 id='ignoring-exception-types'>Ignoring exception types</h3><p>govuk_app_config has a list of ignorable exceptions (
<a href="https://github.com/alphagov/govuk_app_config/blob/b911c5bbef9bd1df6a92cf31eb5a8e0d3a91d851/lib/govuk_app_config/govuk_error/configure.rb#L20-L50"><code>excluded_exceptions</code></a>). If your
application raises an exception on this list, it will not be logged in Sentry.
Note that sentry-raven also has a
<a href="https://github.com/getsentry/sentry-ruby/blob/fec3fe012adfe80af63d54df1dfa8a0bdc0415b2/sentry-raven/lib/raven/configuration.rb#L199-L221">default list of exceptions to ignore</a>, but
these are <a href="https://github.com/getsentry/sentry-ruby/blob/fec3fe012adfe80af63d54df1dfa8a0bdc0415b2/sentry-raven/lib/raven/configuration.rb#L35-L37">overwritten, rather than appended</a> by
govuk_app_config, so have no meaning on GOV.UK.</p>
<p>Then there is a list of exceptions to ignore if they occur during the nightly
data sync: <a href="https://github.com/alphagov/govuk_app_config/blob/b911c5bbef9bd1df6a92cf31eb5a8e0d3a91d851/lib/govuk_app_config/govuk_error/configure.rb#L57-L65"><code>data_sync_excluded_exceptions</code></a>.
These are exceptions that are commonly raised while the databases and content
store are periodically unavailable.</p>
<p>When determining whether or not to ignore an exception, the exception chain is
inspected. This means if an exception isn&rsquo;t on the ignore list, but its
underlying cause is an exception on the ignore list, then it will be ignored.
This <a href="https://github.com/getsentry/sentry-ruby/blob/82e1ffe711af287ddc23e8517bdb8275beff94d5/sentry-raven/lib/raven/configuration.rb#L449-L455">applies to <code>excluded_exceptions</code></a> and
<a href="https://github.com/alphagov/govuk_app_config/blob/b911c5bbef9bd1df6a92cf31eb5a8e0d3a91d851/lib/govuk_app_config/govuk_error/configuration.rb#L43">to <code>data_sync_excluded_exceptions</code></a>.</p>
<h3 id='advanced-sentry-customisation'>Advanced Sentry customisation</h3><p>For all of the above, you can easily
<a href="https://github.com/alphagov/govuk_app_config/blob/master/README.md#error-reporting">configure any of these properties by appending to them</a>.</p>
<p>You can also run arbitrary code to decide whether or not an error should be
logged in Sentry, using the <code>before_send</code> lambda. Your custom code will be
<a href="https://github.com/alphagov/govuk_app_config/blob/589b7aae49c3584ead2f60f915be05a7922c5c3e/lib/govuk_app_config/govuk_error/configuration.rb#L63–L71">combined with the default evaluators</a> such that if any of the
callbacks returns nil, the exception will be excluded.</p>
<h2 id='when-errors-are-received-by-sentry'>When errors are received by Sentry</h2><p>Sentry first fingerprints the error to decide what Issue to group it under.
It then checks how many occurrences of that Issue have happened recently,
and rate-limits (i.e. ignores) this occurrence if it is happening too
frequently. More details below.</p>
<h3 id='fingerprinting'>Fingerprinting</h3><p>Errors are grouped into Issues automatically by Sentry. By default, Sentry
<a href="https://docs.sentry.io/platforms/ruby/data-management/event-grouping/#grouping-by-stack-trace">groups based on stack trace</a>. If no stack trace is
available, it will <a href="https://docs.sentry.io/platforms/ruby/data-management/event-grouping/#grouping-by-exception">group by exception type</a> instead.
Failing that, it will group by error message.</p>
<p>Fingerprint rules can be applied at the project level by editing the
&ldquo;Issue Grouping&rdquo; page under a project (see <a href="https://sentry.io/settings/govuk/projects/app-asset-manager/issue-grouping/">example</a>).
For example, you can force all errors of the same exception type to have the
same fingerprint. On the same screen, you can set stack trace rules, to
remove or rename certain &lsquo;frames&rsquo; in the trace. In practice, we don&rsquo;t
currently apply any custom rules, after an in-depth <a href="https://trello.com/c/NZNjFHWO/284-5-improve-sentrys-grouping-of-exceptions-8">investigation</a>
found that Sentry&rsquo;s default grouping was already very accurate (despite it
often looking like the same exception is spread across multiple issues).</p>
<h4 id='stack-trace-cleaning'>Stack trace cleaning</h4><p>Note that sentry-raven automatically cleans up stack traces for the purposes
of fingerprinting, so that stack trace frames like:</p>
<p><code>app/views/welcome/view_error.html.erb in _app_views_welcome_view_error_html_erb__2807287320172182514_65600 at line 1</code></p>
<p>&hellip;get normalised to:</p>
<p><code>app/views/welcome/view_error.html.erb at line 1</code></p>
<p>This means if the same <code>ActionView::Template::Error</code> error happens twice, it
is grouped into the same issue instead of erroneously treated as separate issues.</p>
<p>sentry-raven uses a <a href="https://github.com/getsentry/sentry-ruby/pull/1011/files#diff-c01d5cbc846720e47a4185cb501a55225247ec698aa169b0a2773ca9b65ae35dR1-R29">customised version</a> of
<code>Rails::BacktraceCleaner</code> to do this. The
<a href="https://github.com/rails/rails/blob/b66235d432d0505857ff667e0a1ddecfb5640a56/railties/lib/rails/backtrace_cleaner.rb">original <code>BacktraceCleaner</code></a> would do this, but also
remove any &ldquo;framework trace&rdquo; from the stacktrace, leaving only the &ldquo;application
trace&rdquo; behind. The original <code>BacktraceCleaner</code> would actually be beneficial for
grouping, as Sentry is very sensitive to stack traces that differ only slightly
(which can happen when a dependency is updated or a Ruby version is upgraded).
However, removing the framework traces entirely means losing key diagnostic
information, so the customised, less aggressive <code>BacktraceCleaner</code> is a better
choice.</p>
<h3 id='rate-limiting'>Rate limiting</h3><p>GOV.UK is on a legacy billing plan with an account limit of 1000 events per hour.
When this limit is reached, subsequent events get discarded, meaning that noisy
issues can prevent other, more important issues from being logged.</p>
<p>In practice, it&rsquo;s more complicated than that. We have a per-project limit of 50%,
the lowest that Sentry allows. This means that any one project on Sentry cannot
log more than 500 events before it is rate limited. This is a protection
mechanism, ensuring that we would need two projects to be recording high-volume
errors to risk breaching our account limit. These limits are configured on the
<a href="https://sentry.io/settings/govuk/rate-limits/">Rate Limits</a> page.</p>
<h2 id='slack-alerts'>Slack alerts</h2><p>You can configure Sentry to notify a Slack channel when a condition is
satisfied, such as when any issue records 100 or more errors in a 1 hour period.</p>
<p>To set up an alert, visit the <a href="https://sentry.io/organizations/govuk/alerts/rules/">Alerts panel</a>, select the project the alert
should apply to (e.g. <code>app-whitehall</code>), and then click &ldquo;Create Alert Rule&rdquo;. It is
currently not possible to set up a &lsquo;global&rsquo; alert to apply to all projects at
once.</p>
<p>We encourage teams to set up alerts for any projects they&rsquo;re responsible for, so
that they can be alerted to new and high-volume issues and prioritise them.
Multiple teams are allowed to set up alerts for the same projects.</p>
<h2 id='sentry-issue-actions'>Sentry issue actions</h2><p>In the Sentry UI, you can merge related issues together, resolve issues, or
archive issues (permanently or for a set time period).</p>
<h3 id='merging-sentry-issues'>Merging Sentry issues</h3><p>Duplicate issues can be merged by going into the project view, checking the
boxes associated with each issue, and clicking &ldquo;Merge&rdquo;. This should be done very
carefully, as issues cannot be unmerged once they are merged, and the issues are
often subtly different and warrant being separate issues. For example, they may
have the same exception type but occur in different transactions, so require two
separate fixes.</p>
<p>To find out why Sentry has treated two issues as separate, visit each issue and
scroll to the bottom of the page to see the &ldquo;Event grouping information&rdquo;.</p>
<h3 id='resolving-an-issue'>Resolving an issue</h3><p>When you know you&rsquo;ve fixed the underlying issue, you should
<a href="#commenting-on-an-issue">comment on the issue</a> explaining what you&rsquo;ve done, and then
click the &ldquo;Resolve&rdquo; button. This removes it from the default Sentry UI, making it
less noisy, but also has the advantage of marking it as a regression and emailing
you if the issue occurs again.</p>
<h3 id='archiving-or-ignoring-an-issue'>Archiving (or ignoring) an issue</h3><p>You can &ldquo;Archive&rdquo; something for a set period of time - this option used to
be called &ldquo;Ignore&rdquo; in Sentry. Archiving an issue for a set period of time can be
useful if you&rsquo;ve identified an issue and written it up as a Trello card (or are
actively working on fixing it), as it prevents Sentry from accumulating events
and potentially spamming your Slack channel.</p>
<p>In these cases, you should <a href="#commenting-on-an-issue">comment on the issue</a> with a link to
your card or PR, then archive the issue for a set period . You should also set the
&ldquo;Assignee&rdquo; to yourself.</p>
<p>You can always un-archive an issue later if needed.</p>
<h3 id='commenting-on-an-issue'>Commenting on an issue</h3><p>Click on the issue, then on the &ldquo;Activity&rdquo; tab, where you can leave a comment.
Comments support markdown.</p>
<h3 id='deleting-and-discarding-an-issue'>Deleting and discarding an issue</h3><p>If you&rsquo;ve identified an issue that is high-volume, but is unlikely to be fixed any
time soon, you can <a href="https://blog.sentry.io/2018/01/03/delete-and-discard">Delete and Discard</a> the issue by clicking the arrow next to
the trash can and selecting &ldquo;Delete and discard future events&rdquo;.</p>
<p>This should only be used when the issue is likely to have a significant impact on
our <a href="#rate-limiting">Sentry quota</a>. It is possible to &ldquo;undiscard&rdquo; the issue later,
but this will only capture new events. Any events prior to the &ldquo;undiscard&rdquo; action
are lost.</p>
<h2 id='gds-wide-usage-of-sentry'>GDS-wide usage of Sentry</h2><p>Sentry is used by several programmes in GDS, not just GOV.UK. A report,
<a href="https://docs.google.com/document/d/1yVa9iiu-DayGy-MtlrdXeV0E09CsetUenZJCmusLfLg/edit">GDS use of Sentry.io</a>,
covers this in more detail, including documenting some of the limitations of the
setup.</p>
<h2 id='retention-period'>Retention period</h2><p><a href="https://sentry.io/security/#data-retention">90 days</a>.</p>

  <div class='related-content'>

    <h3>More in the Monitoring and alerting section</h3>

    <div class='govuk-grid-row'>
        <div class='govuk-grid-column-one-half'>
          <h4>Learn</h4>

          <ul class="govuk-list">
            <li><a href="/manual/pagerduty.html">PagerDuty</a></li>
            <li><a href="/manual/pingdom-bouncer-canary-check.html">Pingdom Bouncer canary check</a></li>
            <li><a href="/manual/prometheus-grafana-and-alertmanager.html">Prometheus, grafana and alertmanager</a></li>
            <li><a href="/manual/sidekiq.html">Sidekiq</a></li>
          </ul>
        </div>

        <div class='govuk-grid-column-one-half'>
          <h4>How to...</h4>

          <ul class="govuk-list">
            <li><a href="/manual/alerts/chat-ai-alerts.html">GOV.UK Chat Alerts</a></li>
            <li><a href="/manual/errors.html">How we handle errors</a></li>
            <li><a href="/manual/pingdom.html">Pingdom</a></li>
            <li><a href="/manual/how-to-rotate-fastly-api-keys-for-prometheus-exporter.html">Rotate Fastly automation token for Prometheus exporter</a></li>
            <li><a href="/manual/alerts/RouterErrorRatioTooHigh.html">Router error ratio too high</a></li>
            <li><a href="/manual/alerts/signon-api-user-token-expires-soon.html">Signon API user token expires soon</a></li>
            <li><a href="/manual/alerts/email-alerts-travel-medical.html">Travel Advice or Drug and Medical Device email alerts not sent</a></li>
            <li><a href="/manual/alerts/whitehall-error-ratio-too-high.html">Whitehall error ratio too high</a></li>
          </ul>
        </div>

    </div>
</div>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/govuk-developer-docs/blob/master/source/manual/sentry.html.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27Sentry%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Fmanual%2Fsentry.html%29&amp;labels=bug&amp;title=Re%3A+%27Sentry%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
