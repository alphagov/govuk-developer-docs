





<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>GOV.UK Site search alerts and monitoring - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/manual/search-alerts-and-monitoring.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="GOV.UK Site search alerts and monitoring - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/manual/search-alerts-and-monitoring.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="GOV.UK Site search alerts and monitoring" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/manual/search-alerts-and-monitoring.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>We’d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/manual.html" aria-current="page">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/apps.html">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <a href='/manual.html' class="toc__back-link govuk-link">&lsaquo; Manual</a>
  <ul>
  <li>
    <a href="#header"><span>GOV.UK Site search alerts and monitoring</span></a>
    <ul>
      <li>
        <a href="#monitoring-and-alerting-tools"><span>Monitoring and alerting tools</span></a>
        <ul>
          <li>
            <a href="#sentry"><span>Sentry</span></a>
          </li>
          <li>
            <a href="#kibana"><span>Kibana</span></a>
          </li>
          <li>
            <a href="#grafana"><span>Grafana</span></a>
          </li>
          <li>
            <a href="#alertmanager"><span>Alertmanager</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#alert-types-and-how-to-handle-them"><span>Alert types and how to handle them</span></a>
        <ul>
          <li>
            <a href="#degradation-of-service-alerts"><span>Degradation of service alerts</span></a>
          </li>
          <li>
            <a href="#degradation-of-search-quality-alerts"><span>Degradation of search quality alerts</span></a>
          </li>
          <li>
            <a href="#failures-running-evaluations-related-rake-tasks"><span>Failures running evaluations related rake tasks</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#how-to-contact-google-if-there-is-a-critical-issue-with-gcp-or-google-vertex-ai-search"><span>How to contact Google if there is a critical issue with GCP or Google Vertex AI Search</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
                
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Search on GOV.UK",
        "@id": "http://www.dev.gov.uk/manual.html#search-on-gov-uk"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/manual.html#search-on-gov-uk">Search on GOV.UK</a>
        </li>
  </ol>
</nav>
   <div class="govuk-!-font-size-16 govuk-!-margin-top-6">

  Last updated: <a href="https://github.com/alphagov/govuk-developer-docs/commit/9246fe343f460936b9cd4a824c87d7e445bf72cb">12 Jan 2026</a>
</div>

 <h1 id='header'>GOV.UK Site search alerts and monitoring</h1> <p>As described in <a href="/manual/govuk-search.html">GOV.UK Search: How it works</a> there are two search stacks on GOV.UK. This page includes information on the monitoring and alerting for GOV.UK site search only.</p>
<h2 id='monitoring-and-alerting-tools'>Monitoring and alerting tools</h2><h3 id='sentry'>Sentry</h3><p>Sentry is set up to track application errors from <a href="https://govuk.sentry.io/insights/projects/app-finder-frontend/?project=202224">Finder Frontend</a>, <a href="https://govuk.sentry.io/insights/projects/app-search-api-v2/?project=4505862568935424">Search API v2</a> and <a href="https://govuk.sentry.io/insights/projects/app-search-api-v2-beta-features/?project=4510158725513217">Search API v2 beta features</a> including the sync process and API calls from frontend apps.</p>
<p>All environments are configured for Slack notifications. Production alerts are routed to #govuk-search-alerts, while alerts for other environments are sent to #govuk-search-alerts-nonprod.</p>
<h3 id='kibana'>Kibana</h3><p><a href="/manual/kibana.html">Kibana</a> can be used to query application logs as per all other GOV.UK apps.</p>
<h3 id='grafana'>Grafana</h3><p>The <a href="https://grafana.eks.production.govuk.digital/d/govuk-search/gov-uk-search?orgId=1&amp;from=now-24h&amp;to=now&amp;timezone=browser">GOV.UK Search Grafana dashboard</a> visualizes core metrics for site search.</p>
<h3 id='alertmanager'>Alertmanager</h3><p>Alertmanager is used to monitor metrics in Prometheus, and send notifications when metrics cross predefined thresholds.</p>
<p>All environments are configured for Slack notifications. Production alerts are routed to #govuk-search-alerts, while alerts for other environments are sent to #govuk-search-alerts-nonprod.</p>
<h2 id='alert-types-and-how-to-handle-them'>Alert types and how to handle them</h2><h3 id='degradation-of-service-alerts'>Degradation of service alerts</h3><p>We monitor and alert on both Search API v2 success rates, and Google Vertex response times.</p>
<h4 id='search-api-v2-success-rates'>Search API v2 success rates</h4><p>We have an informal SLO to maintain a search and autocomplete success rate of about 99.99% over any 24 hour period. There are currently four Alertmanager rules configured in govuk-helm-charts to send notifications on Slack, if rates drop below this:</p>

<ul>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L63">SearchDegradedAcute</a> 5 minute rolling success rate for search requests has dropped below 99% for more than 10 minutes.</p></li>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L115">SearchDegradedMid</a> 1 hour rolling success rate for search requests has dropped below 99.9% for more than 2 hours.</p></li>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L152">SearchDegradedLong</a> 24 hour rolling success rate for search requests has dropped below 99.99% for more than 24 hours.</p></li>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L78">AutocompleteDegradedAcute</a> 5 minute rolling success rate for autocomplete requests has dropped below 90% for more than 10 minutes.</p></li>
</ul>
<h4 id='google-vertex-ai-search-request-durations'>Google Vertex AI Search request durations</h4><p>There is currently one Alertmanager rule configured in govuk-helm-charts, <a href="link-14">HighVertexP90Latency</a>, which sends notifications in Slack if requests to Google Vertex&rsquo;s Search endpoint exceed acceptable duration thresholds.</p>
<h4 id='causes-and-steps-to-take-in-the-event-of-a-degradation-of-service-alert-firing'>Causes and steps to take in the event of a degradation of service alert firing</h4><p>We are aware of the following occasional errors which should not be considered critical and do not need intervention unless they occur consistently for a large number of users and don’t go away by themselves within a few minutes.</p>

<ul>
<li><code>Google::Cloud::DeadlineExceededError</code> A timeout occurred on the Google API</li>
<li><code>Google::Cloud::InternalError</code> An internal error occurred on the Google API</li>
<li><code>AMQ::Protocol::EmptyResponseError</code> RabbitMQ sent an unexpected response, possibly due to restarting (the listener will restart by itself in most cases)</li>
</ul>
<p>If these errors persist and trigger the degradation of service alerts, this indicates an issue with GCP or Google Vertex AI Search.</p>

<ol>
<li>Login to the <a href="https://console.cloud.google.com/welcome?inv=1&amp;invt=Ab3mhA&amp;project=search-api-v2-production">Google Cloud console</a>, and make sure that the project Search API v2 Production is selected.</li>
<li>Under &ldquo;APIs &amp; Services&rdquo; in the GCP Console, review the Discovery Engine API usage for traffic and error rates.</li>
<li>Issues with Vertex should be <a href="#how-to-contact-google-if-there-is-a-critical-issue-with-gcp-or-google-vertex-ai-search">raised with Google</a>.</li>
</ol>
<h3 id='degradation-of-search-quality-alerts'>Degradation of search quality alerts</h3><p>We have additional Alertmanager rules related to search result quality configured in govuk-helm-charts to send notifications on Slack, if search quality drops below given thresholds:</p>

<ul>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L188">SearchQualityDegradedBinaryRecall</a> Top 3 recall for the binary sample query set has dropped below 90% (&ldquo;warning&rdquo; level), and below 80% (&ldquo;critical&rdquo; level).</p></li>
<li><p><a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/monitoring-config/rules/search_api_v2.yaml#L201">SearchQualityDegradedClickstreamNDCG</a> Top 10 NDCG for the clickstream sample query set has dropped below 85% (&ldquo;warning&rdquo; level), and below 75% (&ldquo;critical&rdquo; level).</p></li>
</ul>
<h4 id='steps-to-take-in-the-event-of-a-degradation-of-search-quality-firing'>Steps to take in the event of a degradation of search quality firing</h4><p>Significant drops in search quality need to be investigated by the search team to diagnose the issue and <a href="#how-to-contact-google-if-there-is-a-critical-issue-with-gcp-or-google-vertex-ai-search">raise a support ticket with Google</a>, if appropriate. If you notice a drop in search quality, make sure the Performance Analyst, Product Manager and Delivery Manager on the search team are aware.</p>
<h3 id='failures-running-evaluations-related-rake-tasks'>Failures running evaluations related rake tasks</h3><p>Evaluations are run regularly on a <a href="https://docs.publishing.service.gov.uk/repos/search-api-v2-beta-features/evaluations.html#schedule">schedule</a>, to measure and monitor the quality of search results and notify the search team if quality drops via <a href="#degradation-of-search-quality-alerts">&ldquo;degradation of quality&rdquo;</a> alerts. Parts of this workflow are executed via rake tasks in <a href="https://github.com/alphagov/search-api-v2-beta-features">Search API v2 beta features</a>, and raise errors in Sentry when they fail. The most common errors are:</p>

<ul>
<li><code>Google::Cloud::AlreadyExistsError</code> (Active evaluation already exists): Only one evaluation in each environment is allowed to be run at one time. This error occurs when an evaluation is triggered when there is already one running.</li>
<li><code>Google::Cloud::NotFoundError</code> (SampleQuerySet): Occurs when a sample query set has not been created, but a rake task is attempting to use it.</li>
<li><code>Google::Cloud::NotFoundError</code> (ServingConfig): Occurs when an evaluation cannot locate the specified serving configuration.</li>
</ul>
<p>Because the evaluations feature is in beta, rake tasks can also fail for unexpected reasons.</p>
<h4 id='steps-to-take-in-the-event-of-a-sample-query-set-not-being-created'>Steps to take in the event of a sample query set not being created</h4><p>If a rake task is attempting to use a sample query set that does not exist and a related <code>Google::Cloud::NotFoundError</code> is being raised, the relevant sample query set should be created manually by re-running the <a href="https://argo.eks.integration.govuk.digital/applications/search-api-v2-beta-features?orphaned=false&amp;resource=&amp;node=batch%2FCronJob%2Fapps%2Fsearch-api-v2-beta-features-setup-sample-query-sets">cronJob that creates the sample query sets in Argo</a>. This rake task will run through to create all sample query sets (binary, clickstream and explicit) for the current month, and import the data from BigQuery. Where the sample query set has been created already, the creation of the sample query set will be skipped and the data will be reimported (replaced) into the sample query set.</p>
<p>It is important to ensure that all required sample query sets exist in all environments, since evaluations cannot run without them.</p>
<h4 id='steps-to-take-in-the-event-of-a-failed-evaluation-run'>Steps to take in the event of a failed evaluation run</h4><p>If an evaluation fails for a reason other than a sample query set not existing, take the following steps:</p>

<ol>
<li><p><strong>Check the environment.</strong> If the failure is in production, carry on through the next steps. Otherwise, do nothing. (Quality of search results is less meaningful/important in non-production environments.)</p></li>
<li><p><strong>Check which evaluations have failed by checking logs in Kibana.</strong> To get an effective read on current quality of search results, we need to be regularly reporting our <a href="https://docs.publishing.service.gov.uk/repos/search-api-v2-beta-features/evaluations.html#important-metrics">important metrics</a> for <a href="https://docs.publishing.service.gov.uk/repos/search-api-v2-beta-features/evaluations.html#this-month-and-last-month">&ldquo;this month&rdquo;</a>. In practice this can mean:</p></li>
</ol>
<div class="highlight"><pre class="highlight plaintext" tabindex="0"><code>- Ignoring any failed runs of "last month" evaluations.
- Ignoring any failed runs of the explicit evaluations.
- Ensuring there is a successful run of the "this month" clickstream evaluation at least every other day.
- Ensuring there is a successful run of the "this month" binary evaluation at least twice a day.

If an evaluation needs to be re-run, carry on through the next steps.
</code></pre></div>
<ol>
<li><p><strong>(Optional) Temporarily pause scheduled evaluations.</strong> Because only one evaluation can run at a time in each environment, if a scheduled evaluation starts before an ad-hoc run has finished, the scheduled evaluation is likely to fail and raise more alerts. If you want to avoid this, you can edit the <a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/app-config/values-production.yaml#L3094-L3105">cron schedule</a> in helm charts to temporarily pause scheduled evaluations.</p></li>
<li><p><strong>Re-run the relevant <a href="https://github.com/alphagov/govuk-helm-charts/blob/main/charts/app-config/values-production.yaml#L3094-L3105">evaluation cronJob</a> in Argo for the evaluation that has failed.</strong> Note that the evaluations rake task will run the evaluation for both &ldquo;this month&rdquo; and &ldquo;last month&rdquo;.</p></li>
<li><p><strong>Restore usual schedule of evaluation runs.</strong> This is only relevant if scheduled evaluations were temporarily paused in step 3.</p></li>
</ol>
<h2 id='how-to-contact-google-if-there-is-a-critical-issue-with-gcp-or-google-vertex-ai-search'>How to contact Google if there is a critical issue with GCP or Google Vertex AI Search</h2>
<ol>
<li>To raise a support ticket, you will first need to login to the <a href="https://console.cloud.google.com/welcome?inv=1&amp;invt=Ab3mhA&amp;project=search-api-v2-production">GCP console</a></li>
<li>Navigate to the <a href="https://console.cloud.google.com/support/cases?inv=1&amp;invt=Ab3mhA&amp;project=search-api-v2-production">Support/Cases section</a> and press the GET HELP button, ensuring to provide comprehensive reproduction steps.</li>
<li>For catastrophic issues or if regular support is unresponsive, escalate the problem in the Google Chat space, instructions are linked from the #govuk-search team slack channel. Always include the support case number.</li>
</ol>

  <div class='related-content'>

    <h3>More in the Search on GOV.UK section</h3>

    <div class='govuk-grid-row'>
        <div class='govuk-grid-column-one-half'>
          <h4>Learn</h4>

          <ul class="govuk-list">
            <li><a href="/manual/govuk-search.html">GOV.UK Search: Introduction and overview</a></li>
            <li><a href="/manual/govuk-site-search.html">GOV.UK Site search: How it works</a></li>
            <li><a href="/manual/govuk-sitemap.html">GOV.UK's sitemap</a></li>
          </ul>
        </div>

        <div class='govuk-grid-column-one-half'>
          <h4>How to...</h4>

          <ul class="govuk-list">
            <li><a href="/manual/add-a-best-bet.html">Add a best bet to site search</a></li>
            <li><a href="/manual/boost-or-demote-a-document-in-search.html">Boost or demote a document in site search</a></li>
            <li><a href="/manual/how-to-clear-the-redis-cache.html">How to clear the Redis cache</a></li>
            <li><a href="/manual/get-or-delete-a-document-from-VAIS.html">How to get or delete a document from Vertex</a></li>
            <li><a href="/manual/reindex-elasticsearch.html">How to reindex an Elasticsearch index</a></li>
            <li><a href="/manual/how-to-resync-content-in-vertex.html">How to resync content in Vertex</a></li>
            <li><a href="/manual/prevent-a-page-being-returned-in-search-results.html">Prevent a page being returned in search results</a></li>
            <li><a href="/manual/prevent-an-unhelpful-autocomplete-suggestion.html">Prevent an unhelpful autocomplete suggestion</a></li>
            <li><a href="/manual/search-synchronisation-errors.html">Search synchronisation errors</a></li>
            <li><a href="/manual/what-to-do-if-search-is-down.html">What to do if someone says search is down</a></li>
          </ul>
        </div>

    </div>
</div>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/govuk-developer-docs/blob/master/source/manual/search-alerts-and-monitoring.html.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27GOV.UK+Site+search+alerts+and+monitoring%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Fmanual%2Fsearch-alerts-and-monitoring.html%29&amp;labels=bug&amp;title=Re%3A+%27GOV.UK+Site+search+alerts+and+monitoring%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
