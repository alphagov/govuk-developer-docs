

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>govuk_publishing_components: Real User Metrics - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/govuk_publishing_components/real-user-metrics.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="govuk_publishing_components: Real User Metrics - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/govuk_publishing_components/real-user-metrics.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="govuk_publishing_components: Real User Metrics" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/govuk_publishing_components/real-user-metrics.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>Weâ€™d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/govuk_publishing_components.html" rel="noopener" class="govuk-link">govuk_publishing_components</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/govuk_publishing_components/accessibility_acceptance_criteria.html" rel="noopener" class="govuk-link">Accessibility acceptance criteria</a></li>
    <li><a href="/repos/govuk_publishing_components/auditing.html" rel="noopener" class="govuk-link"># Auditing</a></li>
    <li><a href="/repos/govuk_publishing_components/component-wrapper-helper.html" rel="noopener" class="govuk-link">Component wrapper helper</a></li>
    <li><a href="/repos/govuk_publishing_components/component_branding.html" rel="noopener" class="govuk-link">Component branding</a></li>
    <li><a href="/repos/govuk_publishing_components/component_conventions.html" rel="noopener" class="govuk-link">Component Conventions</a></li>
    <li><a href="/repos/govuk_publishing_components/component_principles.html" rel="noopener" class="govuk-link">Component Principles</a></li>
    <li><a href="/repos/govuk_publishing_components/generate-a-new-component.html" rel="noopener" class="govuk-link">Generate a new component</a></li>
    <li><a href="/repos/govuk_publishing_components/install-and-use.html" rel="noopener" class="govuk-link">Install and use this gem</a></li>
    <li><a href="/repos/govuk_publishing_components/javascript-modules.html" rel="noopener" class="govuk-link"># JavaScript Modules</a></li>
    <li><a href="/repos/govuk_publishing_components/load-analytics.html" rel="noopener" class="govuk-link">Loading analytics into our applications</a></li>
    <li><a href="/repos/govuk_publishing_components/moving-components-upstream-into-this-gem.html" rel="noopener" class="govuk-link">Moving components from an application into this gem</a></li>
    <li><a href="/repos/govuk_publishing_components/organisation-logos.html" rel="noopener" class="govuk-link">Organisation logos</a></li>
    <li><a href="/repos/govuk_publishing_components/publishing-to-rubygems.html" rel="noopener" class="govuk-link">Publishing to RubyGems</a></li>
    <li><a href="/repos/govuk_publishing_components/pull_request_template.html" rel="noopener" class="govuk-link"># What</a></li>
    <li><a href="/repos/govuk_publishing_components/real-user-metrics.html" rel="noopener" class="govuk-link">Real User Metrics</a></li>
    <li><a href="/repos/govuk_publishing_components/set-up-individual-component-css-loading.html" rel="noopener" class="govuk-link">Set up individual component CSS loading</a></li>
    <li><a href="/repos/govuk_publishing_components/test-a-branch-of-the-gem.html" rel="noopener" class="govuk-link">Test a branch of the components gem</a></li>
    <li><a href="/repos/govuk_publishing_components/testing-components.html" rel="noopener" class="govuk-link">Testing components</a></li>
    <li><a href="/repos/govuk_publishing_components/upgrade-govuk-frontend.html" rel="noopener" class="govuk-link">Keep this gem in sync with the Design System</a></li>
    <li><a href="/repos/govuk_publishing_components/use-components.html" rel="noopener" class="govuk-link">Use a component</a></li>
    <li class="subdir__heading">adr</li>
    <ul class="subdir__menu">
          <li><a href="/repos/govuk_publishing_components/adr/0001-record-architecture-decisions.html" rel="noopener" class="govuk-link">1. Record architecture decisions</a></li>
    <li><a href="/repos/govuk_publishing_components/adr/0002-google-analytics-4-tracking-and-code-location.html" rel="noopener" class="govuk-link">2. Google Analytics 4 tracking and code location</a></li>

    </ul>
    <li class="subdir__heading">analytics-ga4</li>
    <ul class="subdir__menu">
          <li><a href="/repos/govuk_publishing_components/analytics-ga4/analytics.html" rel="noopener" class="govuk-link">Google Analytics 4 and Google Tag Manager</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/consent.html" rel="noopener" class="govuk-link">GA4 and cookie consent</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/developer-guide.html" rel="noopener" class="govuk-link">GA4 developer guide</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/developer-installation.html" rel="noopener" class="govuk-link">Using our GA4 tracking in your application</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/middleware.html" rel="noopener" class="govuk-link">Using our GA4 optimisation middleware in your application</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/pii-remover.html" rel="noopener" class="govuk-link">Stripping Personally Identifiable Information (PII)</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/schemas.html" rel="noopener" class="govuk-link">Data schemas</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers.html" rel="noopener" class="govuk-link">Trackers</a></li>
    <li class="subdir__heading">trackers</li>
    <ul class="subdir__menu">
          <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-auto-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 auto tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-copy-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 copy tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-ecommerce-tracker.html" rel="noopener" class="govuk-link">Google Analytics ecommerce tracker (i.e. search)</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-event-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 event tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-finder-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 finder tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-focus-loss-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 focus loss tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-form-change-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 form change tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-form-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 form tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-link-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 link tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-print-intent-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 print intent tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-scroll-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 scroll tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-search-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 search tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-smart-answer-results-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 smart answer results (Cost of Living) tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-specialist-link-tracker.html" rel="noopener" class="govuk-link">Google Analytics Specialist Link Tracker</a></li>
    <li><a href="/repos/govuk_publishing_components/analytics-ga4/trackers/ga4-video-tracker.html" rel="noopener" class="govuk-link">Google Analytics 4 video tracker</a></li>

    </ul>

    </ul>
    <li class="subdir__heading">lib</li>
    <ul class="subdir__menu">
          <li><a href="/repos/govuk_publishing_components/lib/trigger_event.html" rel="noopener" class="govuk-link"># Trigger Event</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Repos",
        "@id": "http://www.dev.gov.uk/repos.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "govuk_publishing_components",
        "@id": "http://www.dev.gov.uk/repos/govuk_publishing_components.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos.html">Repos</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/govuk_publishing_components.html">govuk_publishing_components</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">
    <div class="govuk-warning-text">
      <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
      <strong class="govuk-warning-text__text">
        <span class="govuk-warning-text__assistive">Warning</span>
        This document has not been updated for a while now. It may be out of date.
      </strong>
    </div>

  Last updated: <a href="https://github.com/alphagov/govuk_publishing_components/commit/e7961646cd86c10204efa42b2e717cce573e5662">21 Mar 2025</a>
</div>

  <h1 class="page-title">govuk_publishing_components: Real User Metrics</h1>

  
<p>Real user metrics (RUM) allow a user's browser to report on how a page loaded using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance_API">Performance API</a>. The tool that we use to do this is called <a href="https://speedcurve.com/features/lux/">LUX</a> - short for Live User Experience - and is run by SpeedCurve.</p>
<p>The benefit of RUM is that it shows how pages are performing in real situations, rather than on synthetic tests. This means that we don't have to guess at what conditions might be - RUM provides insight into what conditions actually are.</p>
<h2 id="loading">Loading</h2>
<p>The LUX scripts should only be loaded when a user has opted into usage tracking. This is done using the <code>rum-loader</code> script, which checks if the <code>usage</code> cookie is <code>true</code> and then loads the required scripts. This is already part of the <a href="https://components.publishing.service.gov.uk/component-guide/layout_for_public">Public Layout component</a>.</p>
<h2 id="how-it-works">How it works</h2>
<p>The scripts for the real user metrics are loaded from our servers - this allows us to know what is contained within the scripts and reduce the risk of unwelcome things being added to GOV.UK. Normally LUX is loaded from SpeedCurve's servers, so our setup is unusual.</p>
<h3 id="the-scripts">The scripts</h3>
<p>There are three scripts involved.</p>
<ul>
<li>
<a href="https://github.com/alphagov/govuk_publishing_components/blob/main/app/assets/javascripts/govuk_publishing_components/rum-loader.js">the loader</a> is a script that we wrote. If cookies have been accepted, it <a href="https://github.com/alphagov/govuk_publishing_components/commit/0edd70614589d5fbd2a619483d3a63272714b384#diff-68c3e9ad18ca1324acd992819b248cd5b0e3e336f923a972b98ab09e8a06bd9dR58">finds the LUX script</a>, attaches it to the DOM and executes it. If cookies haven't been accepted, it sets a listener for the <code>cookie-consent</code> event.</li>
<li>
<a href="https://github.com/alphagov/govuk_publishing_components/blob/main/app/assets/javascripts/govuk_publishing_components/vendor/lux/lux-measurer.js">the measurer</a> measures performance from the start of page load, but doesn't report anything. This file shouldn't ever change. The source is from the RUM dashboard, in Settings, Edit RUM, at the end. We don't use this in the way SpeedCurve recommends, because we load the scripts ourselves.</li>
<li>
<a href="https://github.com/alphagov/govuk_publishing_components/blob/main/app/assets/javascripts/govuk_publishing_components/vendor/lux/lux-reporter.js">the reporter</a> is the script that the loader pulls down and attaches to the DOM. This file is <a href="https://github.com/alphagov/govuk_publishing_components/blob/0a70273097ab4cc4abb9b81726c3fc84db880091/app/assets/config/govuk_publishing_components_manifest.js#L12-L13">compiled as a separate asset</a> and isn't included until users consent to cookies.</li>
</ul>
<p>The reporter is the file that SpeedCurve occasionally changes (in SpeedCurve's repo it's called <code>lux.js</code>). Because we load our own modified copy of this script we currently have to manually download and update it. The script is audited before being updated and then two extra lines are added to make sure it works correctly. These two lines set the customer ID and set the sampling rate.</p>
<h3 id="customer-id">Customer ID</h3>
<p>The customer ID is an identifier for the site using LUX, not for the user visiting the site. It won't change from page to page, or from visitor to visitor.</p>
<p>When loading <code>lux.js</code> from SpeedCurve's CDN, the customer ID is appended to the end of the URI as a query string. The script looks for a script in the DOM with a source of <code>lux.js</code>, and from that extracts the customer ID.</p>
<p>Rails adds a fingerprint to the URI which means that <code>lux.js</code> becomes (for example) <code>lux.self-7137780d5344a93190a2c698cd660619d4197420b9b1ef963b639a825a6aa5ff.js</code> and the script can't find itself. Because of this that part of the script would fail. Instead, we modify the <code>getCustomerId()</code> function to simply return <code>LUX.customerid</code>.</p>
<p>Because of this the customer ID needs to be set in the <code>lux.js</code> file:</p>
<pre lang="javascript"><code>LUX.customerid = 47044334
</code></pre>
<h3 id="sending-information">Sending information</h3>
<p>LUX needs the <a href="https://github.com/alphagov/govuk_app_config/blob/87e445eccee5fba2449a170d5ba628e8a380fcb8/lib/govuk_app_config/govuk_content_security_policy.rb#L36-L38">content security policy in <code>govuk_app_config</code></a> to be configured to allow communication to LUX servers. <a href="https://support.speedcurve.com/docs/add-rum-to-your-csp">Documentation</a> is provided on how to configure this.</p>
<h3 id="sample-rate">Sample rate</h3>
<p>LUX defaults to sending every event to SpeedCurve - this can be changed by setting <code>LUX.samplerate</code> to a integer:</p>
<pre lang="javascript"><code>LUX.samplerate = 1 // Whole number from 1 to 100.
</code></pre>
<p>This then only sends 1% of visits.</p>
<p><strong>This must be set at the top of the main <code>LUX</code> function or it will default to 100% sample rate.</strong></p>
<h3 id="debugging-bonus-mode">Debugging (bonus mode)</h3>
<pre lang="javascript"><code>LUX.debug = true
</code></pre>
<p>Debug is turned off by default - setting this to <code>true</code> it will log what LUX is doing in the browser's console.</p>
<p>Usefully, running <code>LUX.getDebug()</code> in the browser's console will show the history of what's happened whether <code>debug</code> is <code>true</code> or <code>false</code>:</p>
<pre lang="javascript"><code>LUX.getDebug()
</code></pre>
<p>Sampling can also be forced by placing <code>LUX.forceSample()</code> at the end of the file:</p>
<pre lang="javascript"><code>LUX.forceSample()
</code></pre>
<h2 id="how-to-update-to-a-new-version">How to update to a new version</h2>
<h3 id="being-notified">Being notified</h3>
<p>2nd line have an icinga alert set up to tell us when a new version of LUX is available. This checks the <a href="https://cdn.speedcurve.com/js/lux.js?id=47044334">live LUX script</a> for a variable called <code>SCRIPT_VERSION</code>. Since the file is minified it is actually looking for the pattern <code>V=[version_number]</code>, where <code>version_number</code> is currently <code>302</code>. If it does not match this, an alert is triggered.</p>
<p>The <a href="https://github.com/alphagov/govuk-puppet/pull/11339">icinga alert was originally added in this PR</a>, for reference.</p>
<h3 id="getting-the-new-code">Getting the new code</h3>
<p>You will need to download the new script from <a href="https://github.com/SpeedCurve-Metrics/lux.js">the SpeedCurve github repo</a>. It's worth turning on notifications for this repo in case the icinga alert fails.</p>
<p>The script is written in TypeScript so you will first need to <code>npm install</code> and <code>npm run build</code> to create a JavaScript version of the file (see repo README for details).</p>
<h3 id="updating">Updating</h3>
<p>To update <code>lux-reporter.js</code>, you'll need to clone <a href="https://github.com/SpeedCurve-Metrics/lux.js">the lux.js source code</a> to your local machine. Run <code>npm install</code> and <code>npm run build</code> in that repo to create a <code>dist/lux.js</code> file.</p>
<p>You can also build the version of <code>lux.js</code> that's currently on GOV.UK by using the source code on their <a href="https://github.com/SpeedCurve-Metrics/lux.js/releases/">releases page</a>. You can then use this to run a diff check of our version against the new version. If the changes are small enough, you could decide to just manually copy and paste the changed lines to our <code>lux-reporter.js</code> file as a simple way to update LUX.</p>
<p>If the changes between versions are large enough, you can copy and paste all the code in the new version of <code>lux.js</code> into our <code>lux-reporter.js</code>. You will then need to update the code to include the variables mentioned below. Try to format the file as well, so that indenting differences don't make reviewing difficult.</p>
<p>Instructions for how to update are in our copy of the file. In summary:</p>
<ul>
<li>
<code>LUX.customerid</code> and <code>LUX.samplerate</code> are the things we need to set (copy them from the current version)</li>
<li>
<code>LUX.customerid</code> has to be inside the <code>LUX = (function () {</code> declaration</li>
<li>update the <code>getCustomerId</code> function to simply return the customerid, see <a href="https://github.com/alphagov/govuk_publishing_components/pull/3592">this PR for related information</a>
</li>
<li>Preserve the comments we have written - there's one at the top of our file, and one next to the <code>LUX = (function () {</code> declaration</li>
</ul>
<h3 id="testing">Testing</h3>
<p>You can test the changes locally to ensure the file has been updated correctly.</p>
<ul>
<li>temporarily set the <code>debug</code> option in the reporter to <code>true</code> for testing purposes</li>
<li>load a local application pointed at your local components gem, and accept cookies</li>
<li>paste this command into the browser console: <code>copy(window.LUX.getDebug())</code> (it'll say <code>undefined</code> but the output will be in your copy/paste buffer)</li>
<li>visit the <a href="https://speedcurve-metrics.github.io/lux.js/debug-parser.html">SpeedCurve debugging tool</a> and paste the output into it, and check the output for errors</li>
</ul>
<p>If you're using docker to run the application, your local server will have a <code>dev.gov.uk</code> domain name and it is possible to set up SpeedCurve to see the data from it. You will need to uncomment the <code>forceSample</code> line to make this work.</p>
<h3 id="check-the-changelog">Check the changelog</h3>
<p>It's worth checking the <a href="https://support.speedcurve.com/changelog">SpeedCurve changelog</a> to see what has been updated with this latest release in case there's anything we want to take advantage of, anything we need to configure in our dashboards, or anything that could be an issue that we should discuss before deploying.</p>
<h2 id="protocol-measuring">Protocol measuring</h2>
<p>We've added an extra bit to the end of the measurer script to <a href="https://github.com/alphagov/govuk_publishing_components/blob/main/app/assets/javascripts/govuk_publishing_components/vendor/lux/lux-measurer.js#L161-L196">determine what protocol is in use</a> - HTTP 1, 2 or 3. This shouldn't need any updating as the measurer shouldn't change.</p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/govuk_publishing_components/blob/main/docs/real-user-metrics.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fgovuk_publishing_components%2Freal-user-metrics.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
