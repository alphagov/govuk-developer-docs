

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>whitehall: Migrating to StandardEdition - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/whitehall/migrating_to_standard_edition.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="whitehall: Migrating to StandardEdition - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/whitehall/migrating_to_standard_edition.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="whitehall: Migrating to StandardEdition" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/whitehall/migrating_to_standard_edition.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>Weâ€™d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/whitehall.html" rel="noopener" class="govuk-link">whitehall</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/whitehall/access_controls.html" rel="noopener" class="govuk-link">Access controls for editions</a></li>
    <li><a href="/repos/whitehall/analytics.html" rel="noopener" class="govuk-link">Analytics</a></li>
    <li><a href="/repos/whitehall/assets.html" rel="noopener" class="govuk-link">assets</a></li>
    <li><a href="/repos/whitehall/auditing.html" rel="noopener" class="govuk-link">Whitehall Content Audit Trail</a></li>
    <li><a href="/repos/whitehall/browser_support.html" rel="noopener" class="govuk-link">Whitehall browser support</a></li>
    <li><a href="/repos/whitehall/configurable_document_types.html" rel="noopener" class="govuk-link">Configurable Document Types</a></li>
    <li><a href="/repos/whitehall/contacts_expansion.html" rel="noopener" class="govuk-link">How does Whitehall handle contact expansion in govspeak?</a></li>
    <li><a href="/repos/whitehall/css.html" rel="noopener" class="govuk-link">Whitehall CSS Styleguide</a></li>
    <li><a href="/repos/whitehall/edition_model.html" rel="noopener" class="govuk-link">Edition Model</a></li>
    <li><a href="/repos/whitehall/edition_workflow.html" rel="noopener" class="govuk-link">Edition Workflow</a></li>
    <li><a href="/repos/whitehall/email_delivery.html" rel="noopener" class="govuk-link">Email delivery</a></li>
    <li><a href="/repos/whitehall/feature_flags.html" rel="noopener" class="govuk-link">Feature Flags</a></li>
    <li><a href="/repos/whitehall/history_mode.html" rel="noopener" class="govuk-link">History Mode</a></li>
    <li><a href="/repos/whitehall/internationalisation_guide.html" rel="noopener" class="govuk-link">Internationalisation guide</a></li>
    <li><a href="/repos/whitehall/javascript.html" rel="noopener" class="govuk-link">Whitehall JavaScript</a></li>
    <li><a href="/repos/whitehall/link_checker_api_integration.html" rel="noopener" class="govuk-link">Link Checker API Integrations</a></li>
    <li><a href="/repos/whitehall/migrating_to_standard_edition.html" rel="noopener" class="govuk-link">Migrating to StandardEdition</a></li>
    <li><a href="/repos/whitehall/pushing_content_to_publishing_api.html" rel="noopener" class="govuk-link">Pushing content to Publishing API</a></li>
    <li><a href="/repos/whitehall/remove_access_limited.html" rel="noopener" class="govuk-link">Access limited</a></li>
    <li><a href="/repos/whitehall/search_indexing.html" rel="noopener" class="govuk-link">Search Indexing</a></li>
    <li><a href="/repos/whitehall/timestamps.html" rel="noopener" class="govuk-link">Timestamps</a></li>
    <li><a href="/repos/whitehall/tips_for_local_development.html" rel="noopener" class="govuk-link">Tips for working on Whitehall locally</a></li>
    <li><a href="/repos/whitehall/troubleshooting.html" rel="noopener" class="govuk-link">Whitehall troubleshooting</a></li>
    <li><a href="/repos/whitehall/view_components.html" rel="noopener" class="govuk-link">View Components</a></li>
    <li class="subdir__heading">adr</li>
    <ul class="subdir__menu">
          <li><a href="/repos/whitehall/adr/0001-add-view-components.html" rel="noopener" class="govuk-link">1. Add View Components</a></li>
    <li><a href="/repos/whitehall/adr/0002-new-asset-model.html" rel="noopener" class="govuk-link">2. New Asset Model</a></li>
    <li><a href="/repos/whitehall/adr/0003-worldwide-organisation-multi-part-content.html" rel="noopener" class="govuk-link">3. Using multi-part content for Worldwide Organisations</a></li>
    <li><a href="/repos/whitehall/adr/0004-content-object-store-added-with-a-rails-engine.html" rel="noopener" class="govuk-link">4. content-object-store-added-with-a-rails-engine</a></li>
    <li><a href="/repos/whitehall/adr/0005-use-json-schema-for-flexible-page-schemas.html" rel="noopener" class="govuk-link">5. Use JSON Schema for configurable document schemas</a></li>
    <li><a href="/repos/whitehall/adr/0006-config-driven-content-types.html" rel="noopener" class="govuk-link">6. Config driven content types</a></li>
    <li><a href="/repos/whitehall/adr/0007-use-rails-validation-for-configurable-documents.html" rel="noopener" class="govuk-link">7. Use Rails validation for configurable documents</a></li>
    <li><a href="/repos/whitehall/adr/0008-drop-json-schema-for-document-configuration.html" rel="noopener" class="govuk-link">8. Drop JSON schema for specifying document properties in favour of our own custom schema definition</a></li>
    <li><a href="/repos/whitehall/adr/0009-configurable-document-forms-and-presenters.html" rel="noopener" class="govuk-link">9. Separate configurable document forms and presenters from attribute schema</a></li>

    </ul>
    <li class="subdir__heading">diagrams</li>
    <ul class="subdir__menu">
          <li><a href="/repos/whitehall/diagrams/README.html" rel="noopener" class="govuk-link">PlantUML Diagrams</a></li>

    </ul>
    <li class="subdir__heading">misc</li>
    <ul class="subdir__menu">
          <li><a href="/repos/whitehall/misc/guidelines-for-translators.html" rel="noopener" class="govuk-link">guidelines-for-translators</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "whitehall",
        "@id": "http://www.dev.gov.uk/repos/whitehall.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/whitehall.html">whitehall</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">

  Last updated: <a href="https://github.com/alphagov/whitehall/commit/b2baf988f51ac4a80839d2ed55867c83d6219a2d">9 Feb 2026</a>
</div>

  <h1 class="page-title">whitehall: Migrating to StandardEdition</h1>

  
<p>We're gradually migrating all document types to use the StandardEdition model, as per <a href="https://github.com/alphagov/whitehall/blob/main/docs/adr/0006-config-driven-content-types.md">ADR 006: Config-driven content types</a>.</p>
<h2 id="steps-to-recreate-a-legacy-content-type">Steps to recreate a legacy content type</h2>
<ol>
<li>
<p>Build the legacy content type as a new config-driven format with its own configuration under <code>app/models/configurable_document_types</code>.</p>
</li>
<li>
<p>Backfill the behaviours (this is the difficult bit). You'll want to:</p>
</li>
</ol>
<ul>
<li>Analyse what features and behaviours exist on the legacy content type</li>
<li>Decide which should be carried over to the config-driven version</li>
<li>Consider whether any existing config-driven behaviours can be adapted for your needs. If not,</li>
<li>Build the new behaviour into StandardEdition in a generic way such that other content types could also 'opt in' to the behaviour if required</li>
</ul>
<ol start="3">
<li>"Launch" the new content type by changing the EditionWorkflowController to redirect users to the StandardEdition workflow (<a href="https://github.com/alphagov/whitehall/blob/a9c1b8fbbd6256cd6145a11cbb65cf4e02b59e52/app/controllers/admin/new_document_controller.rb#L53">example</a>)</li>
</ol>
<h2 id="steps-to-migrate-a-legacy-content-type">Steps to migrate a legacy content type</h2>
<p>These steps assume you have already recreated the legacy content type as a StandardEdition (above).</p>
<h3 id="the-legacy-content-type-already-uses-the-edition-model">The legacy content type already uses the Edition model</h3>
<p>If the legacy content type already uses the Edition model, the migration is made much simpler by use of the <a href="https://github.com/alphagov/whitehall/blob/main/app/services/standard_edition_migrator.rb">StandardEditionMigrator</a> class.</p>
<p>The StandardEditionMigrator takes a 'recipe' (<a href="https://github.com/alphagov/whitehall/pull/10814/changes#diff-08a7cc438a61f2e81368a00c4b5753e52a072e2e4ddc30563eb531d4d041f139R1">example</a>) that tells the migrator service how to map the legacy fields to the config-driven <code>block_content</code> structure (<code>map_legacy_fields_to_block_content</code>). It also has built-in payload comparison, so that it can take the Publishing API payload of the legacy content item and 'diff' it against the StandardEdition Publishing API payload of the <em>converted</em> content item, aborting the migration if the diff isn't as expected.</p>
<p>Conceptually, the diff should be empty: converting legacy content types to being config-driven is a straight up refactor that shouldn't affect the end user experience. In practice, the diffs end up being subtly different, so we have to configure the recipe to state which bits of the diff are 'expected'.</p>
<p>The API is as follows:</p>
<ul>
<li>
<code>configurable_document_type</code> - the config-driven 'configurable_document_type', e.g. <code>news_story</code>
</li>
<li>
<code>presenter</code> - the presenter for the legacy content type, e.g. <code>PublishingApi::NewsArticlePresenter</code>
</li>
<li>
<code>map_legacy_fields_to_block_content(edition, translation)</code> - defines which top level 'fields' of the legacy edition should be injected into the <code>block_content</code> of the config-driven edition. E.g. <code>{ "body" =&gt; translation.body }</code>.</li>
<li>
<code>ignore_legacy_content_fields(content)</code> - defines which fields in the <code>details</code> hash of the legacy content item will not be carried over to the <code>details</code> hash of the config-driven content item. (Sometimes we consciously drop fields if they're no longer required). E.g. <code>content[:details].delete(:first_public_at)</code> (which is a legacy field no longer needed - see <a href="https://github.com/alphagov/whitehall/pull/10670">this PR description</a>).</li>
<li>
<code>ignore_new_content_fields(content)</code> - defines which fields in the <code>details</code> hash of the config-driven content item were not present in the legacy content item. E.g. <code>content[:details].delete(:image)</code>
</li>
<li>
<code>ignore_legacy_links(links)</code> - defines which links in the legacy content item will not be carried over to the links of the config-driven content item. E.g. <code>links.delete(:worldwide_organisations)</code>
</li>
<li>
<code>ignore_new_links(links)</code> - defines which links in the config-driven content item were not present on the legacy content item. If no changes, just return unchanged, i.e. <code>links</code>. The same applies to all of the above arguments.</li>
</ul>
<p>The migrator itself offers two methods:</p>
<ul>
<li>
<code>preview</code>: to see how many unique documents and editions are in scope for migration</li>
<li>
<code>migrate!</code>: to perform the actual migration. It takes two arguments:
<ul>
<li>
<code>compare_payloads</code> (default <code>true</code>): runs the legacy content item through its Publishing API presenter and compares it with the converted content item through the StandardEdition presenter, raising an exception if the diff contains any differences not accounted for by the recipe.
It is highly recommended to keep this on, but it does slow down the migration somewhat.</li>
<li>
<code>republish</code> (default <code>false</code>): whether or not to republish the document after it has been migrated.
This is a nice idea in theory, but in practice can cause <a href="https://gov-uk.atlassian.net/browse/WHIT-2766?focusedCommentId=165942">race conditions with document slugs being changed</a>, so use with caution.</li>
</ul>
</li>
</ul>
<p>With that in mind, the steps for migrating a legacy content type to being config-driven is roughly as follows:</p>
<ol>
<li>
<p>Write a recipe and <a href="https://github.com/alphagov/whitehall/pull/10814/changes#diff-54659f36bda92219acd8b13bc0a48192707fcd668c591e4651ddbe5b58981a4bR1">associated tests</a>.</p>
</li>
<li>
<p>See how many unique documents and editions are in scope for migration:
<code>StandardEditionMigrator.new(scope: Document.where(document_type: "NewsArticle")).preview</code></p>
</li>
<li>
<p>Try converting a legacy content item (or several) locally. Example:</p>
<pre lang="ruby"><code>array_of_one_test_document = Document.where(id: NewsArticle.where(id: 1733267).map(&amp;:document_id))
StandardEditionMigrator.new(scope: array_of_one_test_document).migrate!
</code></pre>
<p>If you want a clearer view of what's going on, you could call the worker directly, synchronously:</p>
<pre lang="ruby"><code>StandardEditionMigratorWorker.new.perform(document.id, { "republish" =&gt; true, "compare_payloads" =&gt; true })
</code></pre>
</li>
<li>
<p>Test the converted content item to make sure it still works as expected.</p>
</li>
<li>
<p>Do the same on Integration so that you can also check the converted content item looks as it should on the frontend.
Compare it with how it looks on Production.</p>
</li>
<li>
<p>Repeat the steps locally for more content items.
You will likely run into edge cases you haven't factored in to your recipe, which you'll want to tweak accordingly.</p>
<pre lang="ruby"><code>StandardEditionMigrator.new(scope: Document.where(document_type: "NewsArticle").first(5000)).migrate!(republish: false, compare_payloads: true)
</code></pre>
</li>
<li>
<p>Come up with a plan for the handful of stragglers.
You'll likely run into a few instances that, for whatever reason, cannot be easily auto-migrated.
See <a href="https://gov-uk.atlassian.net/browse/WHIT-2487?focusedCommentId=165943">examples of issues we ran into with NewsArticles</a>.
Typically a little manual intervention is required, e.g. to patch up some data, before you can then invoke the <code>StandardEditionMigratorWorker</code> to complete the migration of the document.</p>
</li>
<li>
<p>Test running the full migration (and any manual patches) on Integration.</p>
</li>
<li>
<p>Run the full migration (and any manual patches) on Production.</p>
</li>
<li>
<p>Celebrate! ðŸ¥³ Then delete the recipe - you won't need it again.</p>
</li>
</ol>
<h3 id="the-legacy-content-type-does-not-use-the-edition-model">The legacy content type does not use the Edition model</h3>
<p>You'll need to perform a bespoke migration.</p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/whitehall/blob/main/docs/migrating_to_standard_edition.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fwhitehall%2Fmigrating_to_standard_edition.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
