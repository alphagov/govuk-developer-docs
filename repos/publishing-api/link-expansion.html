

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>publishing-api: Links and Link Expansion - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/publishing-api/link-expansion.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="publishing-api: Links and Link Expansion - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/publishing-api/link-expansion.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="publishing-api: Links and Link Expansion" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/publishing-api/link-expansion.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>Weâ€™d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/publishing-api.html" rel="noopener" class="govuk-link">publishing-api</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/publishing-api/admin-tasks.html" rel="noopener" class="govuk-link">Admin Tasks</a></li>
    <li><a href="/repos/publishing-api/api.html" rel="noopener" class="govuk-link">Publishing API's API</a></li>
    <li><a href="/repos/publishing-api/data-migration.html" rel="noopener" class="govuk-link">Writing data migrations</a></li>
    <li><a href="/repos/publishing-api/deleting-content.html" rel="noopener" class="govuk-link">Deleting Documents, Editions and Links</a></li>
    <li><a href="/repos/publishing-api/dependency-resolution.html" rel="noopener" class="govuk-link">Dependency Resolution</a></li>
    <li><a href="/repos/publishing-api/link-expansion.html" rel="noopener" class="govuk-link">Links and Link Expansion</a></li>
    <li><a href="/repos/publishing-api/model.html" rel="noopener" class="govuk-link">Publishing API's Model</a></li>
    <li><a href="/repos/publishing-api/publishing-application-examples.html" rel="noopener" class="govuk-link">Publishing application examples</a></li>
    <li><a href="/repos/publishing-api/rabbitmq.html" rel="noopener" class="govuk-link">RabbitMQ</a></li>
    <li class="subdir__heading">arch</li>
    <ul class="subdir__menu">
          <li><a href="/repos/publishing-api/arch/adr-001-use-event-sourcing-pattern.html" rel="noopener" class="govuk-link">Decision record: use event sourcing</a></li>
    <li><a href="/repos/publishing-api/arch/adr-002-dont-log-events-which-result-in-error.html" rel="noopener" class="govuk-link">Decision record: don't log events which result in an error</a></li>
    <li><a href="/repos/publishing-api/arch/adr-003-representation-for-multiple-content-types.html" rel="noopener" class="govuk-link"># Decision Record: Representation for Multiple Content Types</a></li>
    <li><a href="/repos/publishing-api/arch/adr-004-govspeak-and-embedded-content.html" rel="noopener" class="govuk-link"># Decision Record: Govspeak and embedded content</a></li>
    <li><a href="/repos/publishing-api/arch/adr-005-documents-and-editions.html" rel="noopener" class="govuk-link">Decision Record: Resolve consistency and uniqueness in content</a></li>
    <li><a href="/repos/publishing-api/arch/adr-006-new-event-type-for-content-blocks.html" rel="noopener" class="govuk-link">Decision Record: Add new event type to add custom dependency resolution behaviour when a Content Block is updated</a></li>
    <li><a href="/repos/publishing-api/arch/adr-007-move-content-block-rendering-logic-to-external-gem.html" rel="noopener" class="govuk-link">Decision Record: Move Content Block rendering logic to external gem</a></li>
    <li><a href="/repos/publishing-api/arch/adr-008-typing-for-graphql-editions.html" rel="noopener" class="govuk-link">Decision Record: Typing for GraphQL proof of concept</a></li>
    <li><a href="/repos/publishing-api/arch/adr-009-change-linksets-primary-key-to-content-id.html" rel="noopener" class="govuk-link">Decision Record: Change link_sets primary key from serial to content_id</a></li>
    <li><a href="/repos/publishing-api/arch/adr-010-add-content-block-information-to-the-downstream-payload.html" rel="noopener" class="govuk-link">Decision Record: Include Content Block Change Notes in Downstream Payloads</a></li>

    </ul>
    <li class="subdir__heading">archive</li>
    <ul class="subdir__menu">
          <li><a href="/repos/publishing-api/archive/data-cleanup-plan.html" rel="noopener" class="govuk-link">Data Cleanup Plan: 17th December, 2015</a></li>

    </ul>
    <li class="subdir__heading">content_schemas</li>
    <ul class="subdir__menu">
          <li><a href="/repos/publishing-api/content_schemas/adding-a-new-schema.html" rel="noopener" class="govuk-link">Adding a new content schema</a></li>
    <li><a href="/repos/publishing-api/content_schemas/changing-an-existing-content-schema.html" rel="noopener" class="govuk-link">Changing an existing content schema</a></li>
    <li><a href="/repos/publishing-api/content_schemas/contract-testing-against-schemas.html" rel="noopener" class="govuk-link">Contract Testing against Schemas</a></li>
    <li><a href="/repos/publishing-api/content_schemas/retiring-a-schema.html" rel="noopener" class="govuk-link">How to retire a content schema</a></li>
    <li><a href="/repos/publishing-api/content_schemas/working-with-json-schema-keywords.html" rel="noopener" class="govuk-link">Working with JSON Schema keywords</a></li>

    </ul>
    <li class="subdir__heading">model</li>
    <ul class="subdir__menu">
          <li><a href="/repos/publishing-api/model/README.html" rel="noopener" class="govuk-link">README</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "publishing-api",
        "@id": "http://www.dev.gov.uk/repos/publishing-api.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/publishing-api.html">publishing-api</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">
    <div class="govuk-warning-text">
      <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
      <strong class="govuk-warning-text__text">
        <span class="govuk-warning-text__assistive">Warning</span>
        This document has not been updated for a while now. It may be out of date.
      </strong>
    </div>

  Last updated: <a href="https://github.com/alphagov/publishing-api/commit/27d3994800850472e6b63c68eda4a348aee4c135">11 Jun 2024</a>
</div>

  <h1 class="page-title">publishing-api: Links and Link Expansion</h1>

  
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#example-output">Example output</a></li>
<li><a href="#when-it-occurs">When it occurs</a></li>
<li>
<a href="#how-links-are-added">Link lifecycles</a>
<ul>
<li><a href="#put-content---edition-links"><code>put-content</code> - Edition links</a></li>
<li><a href="#patch-link-set---link-set-links"><code>patch-link-set</code> - Link set links</a></li>
</ul>
</li>
<li>
<a href="#types-of-links">Types of links</a>
<ul>
<li><a href="#available-translations">Available translations</a></li>
<li><a href="#direct-links">Direct links</a></li>
<li><a href="#reverse-links">Reverse links</a></li>
<li>
<a href="#recursive-links">Recursive links</a>
<ul>
<li><a href="#recursive-link-paths">Recursive link paths</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#link-presentation">Link presentation</a>
<ul>
<li><a href="#fields">Fields</a></li>
</ul>
</li>
<li>
<a href="#developer-gotchas">Developer gotchas</a>
<ul>
<li><a href="#why-is-this-link-appearing">Why is this link appearing?</a></li>
<li><a href="#why-is-this-link-not-appearing">Why is this link <em>not</em> appearing?</a></li>
<li><a href="#whyhow-does-a-link-have-extra-fields">Why/how does a link have extra fields?</a></li>
<li><a href="#why-does-this-link-havehave-no-child-links">Why does this link have/have no child links?</a></li>
</ul>
</li>
<li><a href="#debugging">Debugging</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Publishing API stores links between content items so that frontend applications can render links to related content on GOV.UK, such as the organisation responsible for publishing the page. These links contain only a reference to the related content item - they don't contain any information about the related content item until they are "expanded".</p>
<p>Link expansion is the process of converting the stored links of an edition into a JSON representation containing more information about the linked content items. The expansion process occurs immediately before sending an edition downstream to the
<a href="https://github.com/alphagov/content-store">Content Store</a>.</p>
<p>A closely related process to this is
<a href="/repos/publishing-api/dependency-resolution.html">dependency resolution</a>, which runs immediately after a document has been presented to Content Store. This is roughly the opposite of link expansion. When a document is updated, Publishing API works out which documents link to the updated document, and presents the linked documents to Content Store with the new expanded link content.</p>
<h2 id="example-output">Example Output</h2>
<p>Below is an abridged example of an edition represented as JSON after link
expansion has occurred.</p>
<pre lang="json"><code>{
  "base_path": "/government/organisations/department-for-transport/about/welsh-language-scheme",
  "content_id": "5f54d009-7631-11e4-a3cb-005056011aef",
  ...
  "links": {
    "organisations": [{
      "analytics_identifier": "D9",
      "api_path": "/api/content/government/organisations/department-for-transport",
      "base_path": "/government/organisations/department-for-transport",
      "content_id": "4c717efc-f47b-478e-a76d-ce1ae0af1946",
      "description": null,
      "document_type": "organisation",
      "locale": "en",
      "public_updated_at": "2015-06-03T13:12:51Z",
      "schema_name": "organisation",
      "title": "Department for Transport",
      "details": {
        "brand": "department-for-transport",
        "logo": {
          "formatted_title": "Department\u003cbr/\u003efor Transport",
          "crest": "single-identity"
        }
      },
      "links": {}
    }],
    "available_translations": [{
      "analytics_identifier": null,
      "api_url": "https://www.gov.uk/api/content/government/organisations/department-for-transport/about/welsh-language-scheme",
      "base_path": "/government/organisations/department-for-transport/about/welsh-language-scheme",
      "content_id": "5f54d009-7631-11e4-a3cb-005056011aef",
      "description": "When conducting public business in Wales, English and Welsh languages are treated equally.",
      "document_type": "welsh_language_scheme",
      "locale": "en",
      "public_updated_at": "2013-06-21T13:22:34Z",
      "schema_name": "corporate_information_page",
      "title": "Welsh language scheme",
      "links": {}
    }, {
      "analytics_identifier": null,
      "api_url": "https://www.gov.uk/api/content/government/organisations/department-for-transport/about/welsh-language-scheme.cy",
      "base_path": "/government/organisations/department-for-transport/about/welsh-language-scheme.cy",
      "content_id": "5f54d009-7631-11e4-a3cb-005056011aef",
      "description": "Wrth gynnal busnes cyhoeddus yng Nghymru, ieithoedd Cymraeg a Saesneg yn cael eu trin yn gyfartal.",
      "document_type": "welsh_language_scheme",
      "locale": "cy",
      "public_updated_at": "2013-06-21T13:22:34Z",
      "schema_name": "corporate_information_page",
      "title": "Cynllun iaith Gymraeg",
      "links": {}
    }]
  },
}
</code></pre>
<p>Within a <code>links</code> JSON object there are keys which indicate the type of link
(<code>link_type</code>), and at the value of those keys is an array of all links of that
type. In the above example there are two types of link: <code>organisations</code> and
<code>available_translations</code> which contain 1 and 2 links respectively.</p>
<h2 id="link-lifecycles">Link Lifecycles</h2>
<p>There are two categories of link with two separate API routes: edition links and link set links.</p>
<h3 id="put-content-edition-links">
<code>put-content</code> - Edition links</h3>
<p>These links are added via the <a href="/repos/publishing-api/api.html"><code>put-content</code></a>
endpoint. They are associated with a single edition of a document.</p>
<p>In cases when there are edition links and link set links which have the same
<code>link_type</code>, the edition links will take precedence during link expansion.</p>
<p>Edition links should be the default approach to link creation, because link set links have the disadvantage of applying to all editions and locales of a document, which is generally not what is required in most use cases. However, edition links have a substantial limitation, which is that <a href="#recursive-links">recursive link expansion</a> is not applied to them. If a document needs to access data from documents more than one link away, then link set links must be used.</p>
<p>There was an attempt to allow recursive expansion of edition links, but we weren't able to complete it. See <a href="https://github.com/alphagov/publishing-api/pull/2605">https://github.com/alphagov/publishing-api/pull/2605</a>.</p>
<h3 id="patch-link-set-link-set-links">
<code>patch-link-set</code> - Link set links</h3>
<p>These links are added via the
<a href="/repos/publishing-api/api.html"><code>patch-link-set</code></a> endpoint. They are
associated with a <code>content_id</code> rather than an <code>edition_id</code>, which therefore associates them with all of the editions and all of the locales of a document.</p>
<p>This is important because it means when they are updated <strong>they will immediately apply to live editions</strong> of a document.</p>
<p>Theoretically there isn't a need for link set links to exist as edition links can serve all of the same use cases. However, edition links are missing the crucial feature of recursive expansion, so we cannot retire link set links. Link set links pre-date edition links.</p>
<h2 id="types-of-links">Types of links</h2>
<h3 id="available-translations">Available translations</h3>
<p>A document can be available in multiple translations. This will be
determined by documents sharing the same <a href="/repos/publishing-api/model.html"><code>content_id</code></a> and
having different <a href="/repos/publishing-api/model.html"><code>locale</code></a> values.</p>
<p>The links for an edition will automatically include the available translations
of editions of documents matching the same <code>content_id</code>, including the current
locale.</p>
<p><strong>Example</strong></p>
<p>For item <code>E</code> which exists in English ("en") and Welsh ("cy") the available
translations links include a link to the "en" and "cy" variations of the
document.</p>
<h3 id="direct-links">Direct links</h3>
<p>These are typical links which have been added via
<a href="#patch-link-set---link-set-links"><code>patch-link-set</code></a> or
<a href="#put-content---edition-links"><code>put-content</code></a>. They are presented with the <code>link_type</code> provided when creating the link.</p>
<p>These links may be <a href="#recursive-links">recursive</a> depending on their
<code>link_type</code>.</p>
<h3 id="reverse-links">Reverse links</h3>
<p>Certain <code>link_types</code> are considered the reverse of others, as configured in the <a href="https://github.com/alphagov/publishing-api/blob/main/docs/lib/expansion_rules.rb:59">expansion link rules</a>.</p>
<p>A reverse link corresponds with a direct link and has a reverse name. For
instance <code>parent</code> has a reverse name of <code>children</code>.</p>
<p><strong>Example</strong></p>
<p>For item <code>A</code> which has a link to <code>B</code> which is a reverse <code>link_type</code> of parent.
<code>A</code> will be presented with a link to <code>B</code> of type <code>parent</code>, whereas <code>B</code> will be
presented with a link to <code>A</code> of type <code>children</code>.</p>
<p>A quirk of reverse links is that they are presented with their corresponding
link. For example when presenting a collection of links with a type of
<code>children</code>, each one of those links will have a link of type <code>parent</code> which
links to the original content.</p>
<p>These links may be <a href="#recursive-links">recursive</a> dependant on their <code>link_type</code>,
they are defined in <a href="https://github.com/alphagov/publishing-api/blob/main/lib/expansion_rules/link_expansion.rb"><code>LinkExpansion::Rules</code></a>.</p>
<h3 id="recursive-links">Recursive links</h3>
<p>Some link types are considered recursive. These types are used to present a tree
structure of links and are frequently a source of confusion.</p>
<p>Recursive links are used in cases where multiple levels of links are needed to render
content. A common use case for this is breadcrumbs, where we may want to know the
hierarchy from the root <code>/</code> page to the page we are on. Breadcrumbs are represented
by using a recursive <code>parent</code> link type.</p>
<p><strong>Example</strong></p>
<p>Consider the page <a href="https://www.gov.uk/government/collections/apprenticeship-standards">Apprenticeship Standards</a> which
has breadcrumbs of "Home &gt; Further education and skills &gt; Apprenticeships"</p>
<ul>
<li>"Apprenticeship Standards" would have a link to "Apprenticeships" of type
<code>parent</code>.</li>
<li>"Apprenticeships" would have a link to "Further education and skills" of type
<code>parent</code>.</li>
<li>"Further education and skills" could have a link to "Home" of type <code>parent</code>.</li>
</ul>
<p>As <code>parent</code> is a recursive link type each link would include a link to its
subsequent parent forming a graph of:</p>
<pre><code>"Apprenticeship Standards" -parent-&gt; "Apprenticeships" -parent-&gt; "Further education and skills" -parent-&gt; "Home"
</code></pre>
<p>From which breadcrumbs can be generated.</p>
<h4 id="recursive-link-paths">Recursive link paths</h4>
<p>Recursive links can be defined as a path of link types, which means that only
a structure of links that matches the defined path will be included in link
expansion.</p>
<p>An example of this is the path of <code>ordered_related_items</code>,
<code>mainstream_browse_pages</code> and <code>parent</code>. Only a tree of links that match this
path would be included in link expansion.</p>
<p>This path would be included in the links representation for an item <code>A</code>:</p>
<pre><code>"Item A" -ordered_related_items-&gt; "Item B" -mainstream_browse_pages-&gt; "Item C" -parent-&gt; "Item D"
</code></pre>
<p>However this path would not be:</p>
<pre><code>"Item A" -mainstream_browse_pages-&gt; "Item B" -ordered_related_items-&gt; "Item C" -parent-&gt; "Item D"
</code></pre>
<p>An item in a path of link types can be marked as <em>recurring</em>. This means that
there can be many items of this type in the path.</p>
<p>For the path <code>ordered_related_items</code>, <code>mainstream_browse_pages</code> and
<code>parent.recurring</code> there be any number of <code>parent</code> items, and only 1 instance
of <code>ordered_related_items</code> and <code>mainstream_browse_pages</code>.</p>
<p>This is a valid path for <code>ordered_related_items</code>, <code>mainstream_browse_pages</code> and <code>parent</code>:</p>
<pre><code>"Item A" -ordered_related_items-&gt; "Item B" -mainstream_browse_pages-&gt; "Item C" -parent-&gt; "Item D" -parent-&gt; "Item E" -parent-&gt; "Item F"
</code></pre>
<p>Yet this is invalid:</p>
<pre><code>"Item A" -ordered_related_items-&gt; "Item B" -mainstream_browse_pages-&gt; "Item C" -mainstream_browse_pages-&gt; "Item D" -parent-&gt; "Item E" -parent-&gt; "Item F"
</code></pre>
<p>The rules for recursive link types are defined in
<a href="https://github.com/alphagov/publishing-api/blob/main/lib/expansion_rules/link_expansion.rb"><code>LinkExpansion::Rules</code></a>.</p>
<h2 id="edition-state-and-links">Edition state and links</h2>
<p>Whether a link is included during link expansion depends on which <a href="/repos/publishing-api/model.html">state</a> the linked item is in.</p>
<h3 id="edition-has-a-state-of-published-or-unpublished">Edition has a state of <code>published</code> or <code>unpublished</code>
</h3>
<p>Links are included when the linked edition exists in a <code>published</code> state. Editions
that are in an <code>unpublished</code> state with type <code>withdrawn</code> may be linked to
depending on their <code>link_type</code>. Editions that are <code>unpublished</code> but not <code>withdrawn</code> are not linked.</p>
<p>The <code>link_types</code> that define whether a withdrawn edition is linked to are defined
in <a href="https://github.com/alphagov/publishing-api/blob/main/lib/link_expansion.rb">LinkExpansion</a>.</p>
<h3 id="edition-has-a-state-of-draft">Edition has a state of <code>draft</code>
</h3>
<p>Links to draft editions are only included if the item which is having its links expanded is also in the draft state.</p>
<h2 id="link-presentation">Link presentation</h2>
<p>Links are presented as a JSON object where the keys of the object define the link
types and for each link type there is an array of links.</p>
<p>The ordering of links is determined by the order in which the links were added
via <code>patch-link-set</code>. Automatic link types (e.g. translations) do not have a specific ordering.</p>
<h3 id="fields">Fields</h3>
<p>By default links contain the following fields:</p>
<ul>
<li>
<code>analytics_identifier</code> - Used to track a content item in analytics software</li>
<li>
<code>api_path</code> - The path to the JSON representation of this item</li>
<li>
<code>base_path</code> - The public path to this item</li>
<li>
<code>content_id</code> - A UUID to represents the document</li>
<li>
<code>description</code> - A short description of the content</li>
<li>
<code>document_type</code> - This describes a type of document used on GOV.UK and
allowed by the schema</li>
<li>
<code>locale</code> - The language this document is written in</li>
<li>
<code>public_updated_at</code> - The date/time that this document  was last changed</li>
<li>
<code>schema_name</code> - The schema (in <code>content_schemas</code>) that this edition conforms to</li>
<li>
<code>title</code> - The title of the edition</li>
<li>
<code>links</code> - Any <a href="#recursive-links">recursive links</a> that are presented with a
link representation of an edition</li>
</ul>
<p>The fields can be customised per <code>link_type</code>. These customisations are defined in
<a href="https://github.com/alphagov/publishing-api/blob/main/lib/expansion_rules/link_expansion.rb"><code>LinkExpansion::Rules</code></a>.</p>
<h2 id="developer-gotchas">Developer gotchas</h2>
<p>Link expansion is complicated and thus can be challenging for developers to
understand. This section attempts to cover some of the common questions,
we always welcome any suggestions to simplify link expansion.</p>
<h3 id="why-is-this-link-appearing">Why is this link appearing?</h3>
<p>To understand why a link is presented the following things should be considered:</p>
<ul>
<li>If the link is an <code>available_translations</code> link it will be a
<a href="#available-translations">translation</a> of the document;</li>
<li>The link could be a <a href="#direct-links">direct link</a> from the
<a href="/repos/publishing-api/model.html"><code>Edition</code></a> or <a href="/repos/publishing-api/model.html"><code>LinkSet</code></a>;</li>
<li>The link could be a link defined on a different Edition or LinkSet and be
a <a href="#reverse-links">reverse link</a> and represented reciprocally;</li>
<li>If the link is defined inside a different link it will be either be a
<a href="#recursive-links">recursive link</a> or it will be the counterpart of a <a href="#reverse-links">reverse link</a>.</li>
</ul>
<h3 id="why-is-this-link-not-appearing">Why is this link <em>not</em> appearing?</h3>
<p>A link that you expect to appear might not be appearing for one of the following
reasons:</p>
<ul>
<li>The item to be linked to might not be available in a
<a href="#edition-state-and-links">linkable state</a>;</li>
<li>If it is a link set link, there could be <a href="/repos/publishing-api/model.html"><code>Edition</code></a>
links that are defined with the same <code>link_type</code> which means the edition
links will take precedence.</li>
<li>If a recursive link is expected it may not be following a valid
<a href="#recursive-link-paths">recursive link path</a>.</li>
</ul>
<h3 id="whyhow-does-a-link-have-different-fields-to-other-links">Why/how does a link have different fields to other links?</h3>
<p>Links for a specific <code>link_type</code> can be defined to return
<a href="#fields">different fields</a> as part of link expansion. These are defined in
<a href="https://github.com/alphagov/publishing-api/blob/main/lib/expansion_rules/link_expansion.rb"><code>LinkExpansion::Rules</code></a>.</p>
<h2 id="debugging">Debugging</h2>
<p>You can explore link expansion in the rails console by creating a
<a href="https://github.com/alphagov/publishing-api/blob/main/lib/link_expansion.rb"><code>LinkExpansion</code></a> instance.</p>
<pre><code>&gt; link_expansion = LinkExpansion.by_content_id(content_id, locale: :en, with_drafts: true)
</code></pre>
<p>You can then print the <a href="https://github.com/alphagov/publishing-api/blob/main/app/models/link_graph.rb"><code>link_graph</code></a> of the link expansion to view
the links.</p>
<pre><code>&gt; link_expansion.link_graph.to_h
=&gt; {:organisations=&gt;
  [{:content_id=&gt;"2e7868a8-38f5-4ff6-b62f-9a15d1c22d28", :links=&gt;{}},
   {:content_id=&gt;"b548a09f-8b35-4104-89f4-f1a40bf3136d", :links=&gt;{}},
   {:content_id=&gt;"de4e9dc6-cca4-43af-a594-682023b84d6c", :links=&gt;{}},
   {:content_id=&gt;"e8fae147-6232-4163-a3f1-1c15b755a8a4", :links=&gt;{}}],
 :related=&gt;[{:content_id=&gt;"78cedbfe-d3aa-41c3-b8c0-aeb5d9035d6a", :links=&gt;{}}]}
</code></pre>
<p>You can navigate through the <code>link_graph</code> object for further debugging
information.</p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/publishing-api/blob/main/docs/link-expansion.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fpublishing-api%2Flink-expansion.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
