

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>content-block-manager: 3. Move out to new Application - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/content-block-manager/architecture/decisions/0003-move-out-to-new-application.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="content-block-manager: 3. Move out to new Application - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/content-block-manager/architecture/decisions/0003-move-out-to-new-application.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="content-block-manager: 3. Move out to new Application" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/content-block-manager/architecture/decisions/0003-move-out-to-new-application.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>We’d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/content-block-manager.html" rel="noopener" class="govuk-link">content-block-manager</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/content-block-manager/adding_a_new_schema.html" rel="noopener" class="govuk-link">Adding a new schema</a></li>
    <li><a href="/repos/content-block-manager/architecture.html" rel="noopener" class="govuk-link">Architecture</a></li>
    <li><a href="/repos/content-block-manager/configuration.html" rel="noopener" class="govuk-link">Configuration</a></li>
    <li><a href="/repos/content-block-manager/content_modelling_team.html" rel="noopener" class="govuk-link">Content Modelling</a></li>
    <li><a href="/repos/content-block-manager/deleting_a_content_block.html" rel="noopener" class="govuk-link">Deleting a content block</a></li>
    <li><a href="/repos/content-block-manager/edition_states.html" rel="noopener" class="govuk-link">Edition States</a></li>
    <li><a href="/repos/content-block-manager/end_to_end_tests.html" rel="noopener" class="govuk-link">End-to-end tests</a></li>
    <li><a href="/repos/content-block-manager/feature_flags.html" rel="noopener" class="govuk-link">Feature Flags</a></li>
    <li><a href="/repos/content-block-manager/how_embedding_works.html" rel="noopener" class="govuk-link">How embedding works</a></li>
    <li><a href="/repos/content-block-manager/previewing_content_blocks.html" rel="noopener" class="govuk-link">Previewing a content block</a></li>
    <li><a href="/repos/content-block-manager/schemas.html" rel="noopener" class="govuk-link">Content Block Schemas</a></li>
    <li><a href="/repos/content-block-manager/tracking_when_a_content_block_changes.html" rel="noopener" class="govuk-link">Tracking when a content block changes</a></li>
    <li><a href="/repos/content-block-manager/use_of_govspeak.html" rel="noopener" class="govuk-link">Use of Govspeak</a></li>
    <li class="subdir__heading">architecture</li>
    <ul class="subdir__menu">
          <li class="subdir__heading">decisions</li>
    <ul class="subdir__menu">
          <li><a href="/repos/content-block-manager/architecture/decisions/0001-document-use-of-services.html" rel="noopener" class="govuk-link">1. Document use of services</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0002-use-publishing-api.html" rel="noopener" class="govuk-link">2. Content Blocks API - Proposal for rendering Content Blocks outside of Documents</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0003-move-out-to-new-application.html" rel="noopener" class="govuk-link">3. Move out to new Application</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0004-allow-order-to-be-specified.html" rel="noopener" class="govuk-link">4. Allow order of items to be specified in blocks</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0005-hide-e2e-related-content-from-users.html" rel="noopener" class="govuk-link">5. Hide E2E related content from users</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0006-transition-from-minitest-to-rspec.html" rel="noopener" class="govuk-link">6. Transition from Minitest to RSpec</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0007-add-fact-check-view-as-a-rails-engine.html" rel="noopener" class="govuk-link">7. Add Fact Check App as a Rails Engine</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0008-allow-non-signon-users-to-access-fact-check-view-via-a-jwt.html" rel="noopener" class="govuk-link">0008-allow-non-signon-users-to-access-fact-check-view-via-a-jwt</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0009-use-domain-events-to-record-edition-history.html" rel="noopener" class="govuk-link">9. Use domain events to record edition history</a></li>
    <li><a href="/repos/content-block-manager/architecture/decisions/0010-make-content-block-manager-the-source-of-truth-for-schemas.html" rel="noopener" class="govuk-link">10. Make Content Block Manager the source of truth for schemas</a></li>

    </ul>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "content-block-manager",
        "@id": "http://www.dev.gov.uk/repos/content-block-manager.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/content-block-manager.html">content-block-manager</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">

  Last updated: <a href="https://github.com/alphagov/content-block-manager/commit/ede15ca7d224f05a9e8ae9296697933abb974534">4 Sep 2025</a>
</div>

  <h1 class="page-title">content-block-manager: 3. Move out to new Application</h1>

  
<p>Date: 2025-08-14</p>
<h2 id="status">Status</h2>
<p>Accepted</p>
<h2 id="context">Context</h2>
<p>The Content Block Manager has until now lived within Whitehall as a Rails
"engine". See <a href="https://github.com/alphagov/whitehall/blob/main/docs/adr/0004-content-object-store-added-with-a-rails-engine.md">ADR 4: Content Object Store added with a Rails Engine</a>.</p>
<p>This has proved to be a good approach for testing the concept of a service
allowing content owners to model reusable blocks of content such as a simple
<a href="https://github.com/alphagov/publishing-api/blob/main/content_schemas/formats/content_block_pension.jsonnet">"Pension rate"</a> or a complex <a href="https://github.com/alphagov/publishing-api/blob/main/content_schemas/formats/content_block_contact.jsonnet">"Contact"</a>.</p>
<h3 id="benefits">Benefits</h3>
<p>The new service has benefited from much existing Whitehall code and ongoing
maintenance effort, including:</p>
<ul>
<li>using "Sign on" authentication and Whitehall role-based access control
(<code>Admin::BaseController</code>)</li>
<li>interfacing with the Publishing API</li>
<li>access to the Govspeak preview mechanism (<code>GOVUK.Modules.GovspeakEditor</code>)</li>
<li>validating schemas (<code>JSONSchemer</code>)</li>
<li>queuing background jobs with Sidekiq</li>
<li>managing dependency updates with dependabot</li>
</ul>
<h3 id="friction-points">Friction points</h3>
<p>We've noted a few points of friction between Content Block Manager and Whitehall:</p>
<ul>
<li>
<p>on a regular basis Whitehall experimental feature branches which aren't up to
date with <code>main</code> are deployed to the integration environment. This is an
entirely valid and necessary practice for the Whitehall team, but this often
causes breaking changes in Content Block Manager features.</p>
</li>
<li>
<p>one of the flip-sides to being a small part of Whitehall is the long build
time. And conversely, from the Whitehall perspective, Content Block Manager is
adding to the size and complexity of its build.</p>
</li>
</ul>
<h3 id="upcoming-developing">Upcoming developing</h3>
<p>More importantly, there are now a number of areas of development where we
believe the costs of being a part of Whitehall will significantly outweigh the
benefits:</p>
<h4 id="access-control">Access control</h4>
<p>We need to start developing a more fine-grained access control system and we
don't want to add more complexity to Whitehall's already long list of roles.
We need to be able to define permissions such as:</p>
<ul>
<li>
<p>a particular user may perform fact-checking and review draft content on a
particular type of content block as a 2nd pair of eyes but not have permission
to do anything else</p>
</li>
<li>
<p>another user may have permission to create and review multiple types of block</p>
</li>
</ul>
<p>At present the authorisation in the new service is very rudimentary and
provisional, with all users with access to Content Block Manager granted admin
control over Whitehall.</p>
<h4 id="interactivity">Interactivity</h4>
<p>We have some rich UI needs which we'd like to meet using approaches which would
be awkward to add to Whitehall. For example, our intention is to build UIs to
allow users to:</p>
<ul>
<li>
<p>drag and drop nested objects within a block to re-order, for example the elements:</p>
<ul>
<li>address b</li>
<li>address a</li>
<li>telephone 2</li>
<li>telephone 1</li>
</ul>
</li>
<li>
<p>view a "hot-reloading" preview of a complex content block whilst editing a
nested object. For example, whilst editing a Govspeak-enabled textarea within
the "telephone 2" nested object, the user will be able to generate a preview of
the composite Contact content-block including the unsaved contents of that
Govspeak textarea.</p>
</li>
</ul>
<p>To offer these features we plan to use Rails' "Hotwire" components, such as
<a href="https://turbo.hotwired.dev/handbook/frames">Turbo Frames</a>. We believe that it would not be practical to introduce this
library to Whitehall. Introducing Turbo as a dependency would cause all pages
within Whitehall to be loaded via Turbo, which may be confusing to users, and
also have unintended consequences elsewhere in the app.</p>
<h2 id="decision">Decision</h2>
<p>We will move Content Block Manager out of Whitehall into its own repository as
a <a href="https://docs.publishing.service.gov.uk/manual/setting-up-new-rails-app.html">new Rails application</a>.</p>
<h2 id="consequences">Consequences</h2>
<p>There are a number of aspects to this work, including:</p>
<h3 id="understand-the-content-block-managers-dependencies">Understand the Content Block Manager's dependencies</h3>
<p>We will do some analysis to understand upfront the dependencies which Content
Block manager has on Whitehall. We believe that <a href="https://github.com/Shopify/packwerk">Packwerk</a> from Shopify may be
helpful.</p>
<h3 id="explore-converting-test-suite-to-rspec">Explore converting test suite to RSpec</h3>
<p>We will investigate the feasibility of converting our test suite from
Minitest to RSpec to align with <a href="https://docs.publishing.service.gov.uk/manual/conventions-for-rails-applications.html#testing-utilities">current GDS testing conventions</a>. To ensure
that behaviour is not inadvertently changed, this would be a secondary step,
after initially porting the Minitest test suite.</p>
<h3 id="lift-and-shift-code">Lift and shift code</h3>
<p>We will "lift and shift" our source code, deferring any refactoring.</p>
<h3 id="move-from-mysql-to-postgresql">Move from MySQL to PostgreSQL</h3>
<p>We will use Postgres rather than MySQL in the new Content Block Manager service.
This aligns with the <a href="https://docs.publishing.service.gov.uk/manual/conventions-for-rails-applications.html#data-storage">Conventions for Rails applications (Data storage)</a>.</p>
<h3 id="provide-continuity-for-blocks-in-production">Provide continuity for block(s) in production</h3>
<p>At present we have only 1 content block in production (<a href="https://github.com/alphagov/publishing-api/blob/main/content_schemas/formats/content_block_pension.jsonnet">"Pension rate"</a>). We
will put together a migration plan to document in detail how we'll switch from
the current service to the new one without interruption.</p>
<h3 id="provision-the-new-application">Provision the new application</h3>
<p>The <a href="https://docs.publishing.service.gov.uk/manual/setting-up-new-rails-app.html">new Rails application</a> will come with a number of necessary features,
including authentication, API adaptors and publishing components.</p>
<p>In addition we will need to:</p>
<ul>
<li>add other dependencies which are currently provided by Whitehall</li>
<li>configure the deployment pipeline through Github Actions</li>
<li>provision Kubernetes infrastructure and set up monitoring / logging</li>
<li>obtain SSL certificates and configure DNS (see
<a href="https://docs.publishing.service.gov.uk/kubernetes/create-app/#content">Kubernetes: Create a new application</a>)</li>
<li>setup application accounts on related / 3rd party services such as Sentry,
Logit, Notify etc.</li>
<li>configure Google Analytics to continue to record user behaviour as is
currently done in Whitehall</li>
<li>understand governance requirements, e.g. for IT healthchecks</li>
<li>implement an on-call rota to support the application out of hours</li>
</ul>
<p>For an overview of responsibilities, see <a href="https://docs.publishing.service.gov.uk/manual/ownership-meaning.html">Application ownership: what ownership means</a>.</p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/content-block-manager/blob/main/docs/architecture/decisions/0003-move-out-to-new-application.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fcontent-block-manager%2Farchitecture%2Fdecisions%2F0003-move-out-to-new-application.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
