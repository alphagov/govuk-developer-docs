

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Application: publisher - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/publisher.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="description" content="Everything about publisher (Publishes mainstream content on GOV.UK)" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="Application: publisher - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/publisher.html" />

      <meta property="og:description" content="Everything about publisher (Publishes mainstream content on GOV.UK)" />
      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="Application: publisher" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/publisher.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>We’d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/publisher.html" rel="noopener" class="govuk-link">publisher</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/publisher/adding-a-promotion-to-a-completed-transaction.html" rel="noopener" class="govuk-link"># Adding new promotions to Completed Transactions</a></li>
    <li><a href="/repos/publisher/fact-checking.html" rel="noopener" class="govuk-link">Fact Checking</a></li>
    <li><a href="/repos/publisher/feature-flags.html" rel="noopener" class="govuk-link">Feature flags</a></li>
    <li><a href="/repos/publisher/homepage.html" rel="noopener" class="govuk-link">Homepage</a></li>
    <li><a href="/repos/publisher/redirecting-parts-after-format-change.html" rel="noopener" class="govuk-link">Redirecting Parts after Format Change</a></li>
    <li><a href="/repos/publisher/simple-smart-answer.html" rel="noopener" class="govuk-link">Simple Smart Answer</a></li>
    <li class="subdir__heading">arch</li>
    <ul class="subdir__menu">
          <li><a href="/repos/publisher/arch/adr-001-service-sign-in-pages-not-linked-to-with-content-id.html" rel="noopener" class="govuk-link">Decision record: Why Service sign in pages aren't linked to from transaction pages using a content id</a></li>
    <li><a href="/repos/publisher/arch/adr-002-service-sign-in-new-format.html" rel="noopener" class="govuk-link">Decision record: Why "Service sign in" is its own format</a></li>
    <li><a href="/repos/publisher/arch/adr-003-using-rake-to-create-service-sign-in-pages.html" rel="noopener" class="govuk-link">Decision record: Why "Service sign in" pages are created using rake tasks</a></li>
    <li><a href="/repos/publisher/arch/adr-004-rendering-service-sign-in-from-government-frontend.html" rel="noopener" class="govuk-link">Decision record: Rendering Service Sign In pages using Government Frontend</a></li>
    <li><a href="/repos/publisher/arch/adr-005-forking-frontend-components-from-govuk-frontend.html" rel="noopener" class="govuk-link">Decision record: Forking frontend components from GOV.UK Frontend</a></li>
    <li><a href="/repos/publisher/arch/adr-006-use-mermaid-for-simple-smart-answer-visualisation.html" rel="noopener" class="govuk-link">ADR 006 - Use Mermaid for Simple Smart Answer Visualisation</a></li>
    <li><a href="/repos/publisher/arch/adr-007-dont-use-asynchronous-javascript-for-simple-smart-answers.html" rel="noopener" class="govuk-link">ADR007 – Don’t use asynchronous javascript for simple smart answers</a></li>
    <li><a href="/repos/publisher/arch/adr-008-use-flipflop-for-feature-toggles.html" rel="noopener" class="govuk-link">ADR008 - Use Flipflop for feature toggles</a></li>
    <li><a href="/repos/publisher/arch/adr-009-replace-mongodb-with-postgres.html" rel="noopener" class="govuk-link">ADR009 - Replace MongoDb with Postgres</a></li>
    <li><a href="/repos/publisher/arch/adr-010-ensuring-consistent-edition-state-when-unpublishing.html" rel="noopener" class="govuk-link">ADR010 - Ensuring consistent edition state when unpublishing</a></li>
    <li><a href="/repos/publisher/arch/adr-011-restricting-access-to-content-by-organisation.html" rel="noopener" class="govuk-link">ADR011 - Restricting access to content by organisation</a></li>
    <li><a href="/repos/publisher/arch/adr-012-mongo-to-postgres-db-schema.html" rel="noopener" class="govuk-link">ADR012 - Migrate MongoDB to PostgreSQL -  Schema/Object model design for Publisher on Postgres</a></li>
    <li><a href="/repos/publisher/arch/adr-013-mongo-to-postgres-edition-uuid-foriegn-key.html" rel="noopener" class="govuk-link">ADR013 - MongoDB to PostgreSQL -  Edition id to be UUID instead of autoincrement BigInt and a column to store old mongo id</a></li>
    <li><a href="/repos/publisher/arch/adr-014-replacement-of-email-based-fact-check-process.html" rel="noopener" class="govuk-link">ADR014 Replacement of Email-based Fact Checking Process in Publisher</a></li>
    <li><a href="/repos/publisher/arch/adr-015-ADR-authentication-for-fact-checking.html" rel="noopener" class="govuk-link">ADR015 Authentication Approach for the Fact Check Tool</a></li>
    <li><a href="/repos/publisher/arch/adr-016-accepting-fact-check-responses-through-api.html" rel="noopener" class="govuk-link">ADR015 Accepting Fact Check responses through API</a></li>
    <li><a href="/repos/publisher/arch/adr-017-migrate-fact-check-handling-to-a-google-oauth-based-system.html" rel="noopener" class="govuk-link">ADR-017 - Migrate fact check handling to a Google OAuth based system</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;2&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
  </ol>
</nav>
  
  <h1 class="page-title">Application: publisher</h1>

  <p>Publishes mainstream content on GOV.UK</p>

<div class="gem-c-summary-list">

      <dl class="govuk-summary-list">
          <div class="govuk-summary-list__row">

            <dt class="govuk-summary-list__key">GitHub</dt>
            <dd class="govuk-summary-list__value"><a href="https://github.com/alphagov/publisher">publisher</a></dd>



</div>          <div class="govuk-summary-list__row">

            <dt class="govuk-summary-list__key">Ownership</dt>
            <dd class="govuk-summary-list__value"><a href="https://gds.slack.com/channels/govuk-publishing-mainstream-experience-tech">#govuk-publishing-mainstream-experience-tech</a></dd>



</div>          <div class="govuk-summary-list__row">

            <dt class="govuk-summary-list__key">Category</dt>
            <dd class="govuk-summary-list__value">Publishing apps</dd>



</div>          <div class="govuk-summary-list__row">

            <dt class="govuk-summary-list__key">Links</dt>
            <dd class="govuk-summary-list__value"><ul class="govuk-list">
    <li><a href="https://publisher.publishing.service.gov.uk" class="govuk-link">publisher.publishing.service.gov.uk</a></li>
    <li><a href="https://sentry.io/govuk/app-publisher" class="govuk-link">Sentry (error tracking)</a></li>
    <li></li>
    <li><a href="https://grafana.eks.production.govuk.digital/d/app-requests/app3a-request-rates-errors-durations?var-app=publisher" class="govuk-link">App dashboard: request rates, errors, durations</a></li>
    <li></li>
    <li></li>
    <li></li>
    <li><a href="https://kibana.logit.io/s/13d1a0b1-f54f-407b-a4e5-f53ba653fac3/app/discover?security_tenant=global#/?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-3h,to:now))&amp;_a=(columns:!(level,request,status,message),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'filebeat-*',key:kubernetes.labels.app_kubernetes_io%2Fname,negate:!f,params:(query:publisher),type:phrase),query:(match_phrase:(kubernetes.labels.app_kubernetes_io%2Fname:publisher)))),index:'filebeat-*',interval:auto,query:(language:kuery,query:''),sort:!())" class="govuk-link">Kibana App Logs (Production, last 3 hours)</a></li>
    <li><a href="https://kibana.logit.io/s/13d1a0b1-f54f-407b-a4e5-f53ba653fac3/app/discover?security_tenant=global#/?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-3h,to:now))&amp;_a=(columns:!(level,message),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'filebeat-*',key:kubernetes.labels.app_kubernetes_io%2Fname,negate:!f,params:(query:publisher-worker),type:phrase),query:(match_phrase:(kubernetes.labels.app_kubernetes_io%2Fname:publisher-worker)))),index:'filebeat-*',interval:auto,query:(language:kuery,query:''),sort:!())" class="govuk-link">Kibana Worker Logs (Production, last 3 hours)</a></li>
    <li><a href="https://argo.eks.production.govuk.digital/applications/cluster-services/publisher" class="govuk-link">Argo CD (publisher)</a></li>
</dd>



</div></dl>
    
</div>
<h2 id='example-pages-published-by-publisher'>Example pages published by publisher</h2><p><ul class="gem-c-list govuk-list">
      <li><a href="https://www.gov.uk/sign-in-universal-credit" class="govuk-link">Sign in to your Universal Credit account</a></li>
      <li><a href="https://www.gov.uk/check-mot-history" class="govuk-link">Check the MOT history of a vehicle</a></li>
      <li><a href="https://www.gov.uk/log-in-register-hmrc-online-services" class="govuk-link">HMRC online services: sign in or set up an account</a></li>
      <li><a href="https://www.gov.uk/universal-credit" class="govuk-link">Universal Credit</a></li>
      <li><a href="https://www.gov.uk/vehicle-tax" class="govuk-link">Tax your vehicle</a></li>
      <li><a href="https://www.gov.uk/get-information-about-a-company" class="govuk-link">Get information about a company</a></li>
      <li><a href="https://www.gov.uk/check-vehicle-tax" class="govuk-link">Check if a vehicle is taxed</a></li>
      <li><a href="https://www.gov.uk/check-mot-status" class="govuk-link">Check the MOT status of a vehicle</a></li>
      <li><a href="https://www.gov.uk/view-driving-licence" class="govuk-link">View or share your driving licence information</a></li>
      <li><a href="https://www.gov.uk/evisa" class="govuk-link">eVisas: access and use your online immigration status</a></li>
</ul></p>
<h2 id='readme'>README</h2><p><div class="embedded-readme"></p>

<p>Publisher is sometimes referred to as &ldquo;mainstream publisher&rdquo;.</p>

<h2 id="live-examples">Live examples</h2>

<ul>
<li><a href="https://www.gov.uk/smart-meters">Answer</a></li>
<li><a href="https://www.gov.uk/done/make-lpa">Completed transaction</a></li>
<li><a href="https://www.gov.uk/council-tax-appeals">Guide</a></li>
<li><a href="https://www.gov.uk/help/accessibility">Help page</a></li>
<li><a href="https://www.gov.uk/complain-about-your-council">Local transactions</a></li>
<li><a href="https://www.gov.uk/ukonline-centre-internet-access-computer-training">Place</a></li>
<li><a href="https://www.gov.uk/log-in-file-self-assessment-tax-return/sign-in">Service sign in</a></li>
<li><a href="https://www.gov.uk/qualify-tax-credits">Simple smart answer</a></li>
<li><a href="https://www.gov.uk/council-tax-bands">Transaction</a></li>
</ul>

<h2 id="retired-formats">Retired formats</h2>

<ul>
<li>Campaign</li>
<li>Programme</li>
<li>Video</li>
<li>Licence (Migrated to Specialist Licence Finder)</li>
</ul>

<h2 id="removed-formats">Removed formats</h2>

<ul>
<li>Business Support - used to be retired, and the documents remained visible, now
they&rsquo;re fully removed as editions and no longer visible in the app (although
the artefacts do still exist).  They have been fully migrated to
specialist-publisher.</li>
</ul>

<h2 id="nomenclature">Nomenclature</h2>

<ul>
<li>
<strong>Artefact</strong>: a document on GOV.UK.</li>
</ul>

<h2 id="technical-documentation">Technical documentation</h2>

<p>This is a Rails application and should follow <a href="https://docs.publishing.service.gov.uk/manual/conventions-for-rails-applications.html">our Rails app conventions</a>.</p>

<p>You can use the <a href="https://github.com/alphagov/govuk-docker">GOV.UK Docker environment</a> to run the application and its tests with all the necessary dependencies.  Follow <a href="https://github.com/alphagov/govuk-docker#usage">the usage instructions</a> to get started.</p>

<h3 id="setting-up-publisher">Setting up Publisher</h3>

<p><strong>You will need the <a href="https://docs.publishing.service.gov.uk/manual/get-started.html#7-install-and-configure-the-gds-cli">GDS CLI installed and configured</a> for these instructions.</strong></p>

<p>You can use GOV.UK Docker to run Publisher locally in your web browser. Some additional setup is required to populate the database and properly connect to the Publishing API for features such as tagging.</p>

<p>After following the instructions above to set up GOV.UK Docker, navigate to <code>~/govuk/govuk-docker</code> and then pull and build Publisher and all its dependencies using:</p>

<pre lang="sh"><code>make publisher
</code></pre>

<p>This step only needs doing once, after this it will pick up changes to your local branches. Re-running this command can be a useful way to wipe your local Publisher container and start fresh if it ends up in a corrupted state.</p>

<p>At this point your local Publisher will be functional, but with no data populated in its database.</p>

<h3 id="publisher-local-database">Publisher Local Database</h3>

<p>While not essential for local operation, it can be useful to download a copy of the Publisher Integration database which is pre-populated with test users and artefacts.</p>

<p>Still in the <code>~/govuk/govuk-docker</code> folder, run:</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rake db:drop #(optional, but recommended if you're not working from a blank slate) 
</code></pre>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rake db:setup
</code></pre>

<pre lang="sh"><code>gds-cli aws govuk-integration-developer --assume-role-ttl 3h ./bin/replicate-postgresql.sh publisher
</code></pre>

<p>As this is a copy of a production database, you will not be able to perform any destructive actions on your local database (e.g. <code>rake db:drop</code>) without also setting <code>DISABLE_DATABASE_ENVIRONMENT_CHECK=1</code>. You can avoid having to do this by setting your database environment to <code>development</code> with:</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rake db:environment:set RAILS_ENV=development
</code></pre>

<p>The test user <code>James Stewart</code> does not have any permissions by default, so you will need to add them. Open the rails console with:</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rails c
</code></pre>

<p>And then run:</p>

<pre lang="ruby"><code>u = User.first
</code></pre>

<pre lang="ruby"><code>u.permissions.append("govuk_editor", "skip_review", "welsh_editor", "sidekiq_admin")
</code></pre>

<pre lang="ruby"><code>u.save
</code></pre>

<p>and finally <code>exit</code> out of the console.</p>

<h3 id="setting-up-publishing-api-optional">Setting up Publishing API (Optional)</h3>

<p>The steps already done will enable most of Publisher&rsquo;s functionality locally. Some features such as tagging also require Publishing API to have a fully populated database.</p>

<p>To set this up, first go into your Docker settings and under Resources increase the disk usage maximum limit. The default 128 GB is not enough to properly run both Publisher and Publishing API.</p>

<p>Increasing the CPU and Memory limits is also recommended to make the resource heavy processing steps quicker. Memory and CPU can be reduced if needed once everything is set up.</p>

<p>Make sure that you&rsquo;re still in the <code>~/govuk/govuk-docker</code> folder and, similarly to Publisher, run:</p>

<pre lang="sh"><code>govuk-docker run publishing-api-lite bundle exec rake db:drop 
</code></pre>

<pre lang="sh"><code>govuk-docker run publishing-api-lite bundle exec rake db:setup
</code></pre>

<pre lang="sh"><code>gds-cli aws govuk-integration-developer ./bin/replicate-postgresql.sh publishing-api
</code></pre>

<p>The file for Publishing API is significantly larger than the one for Publisher (approx 70 GB). Depending on your internet connection, it will likely take over an hour to download, and slightly longer than that again to install.</p>

<p>While the database is building after the download, the shell output for that step isn&rsquo;t fully accurate. It will reach 100%, and then appear to hang in the terminal. Looking directly at the logs in the <code>govuk-docker</code> postgres container will show it still working. Be patient, and the process will eventually  finish and exit on its own.</p>

<p>If you experience an interruption during this process, your database will be left in a corrupted state. If this happens, re-run the <code>rake db:drop</code> and <code>rake db:setup</code> steps followed by the <code>replicate-postgresql</code> command above. It will re-use the already downloaded dump file rather than re-download it.</p>

<h3 id="running-locally">Running Locally</h3>

<p>The app can be run locally using:</p>

<pre lang="sh"><code>govuk-docker up publisher-app
</code></pre>

<p>And then visiting <a href="http://publisher.dev.gov.uk/">http://publisher.dev.gov.uk/</a> in your web browser. The terminal you use to run the command will display useful server activity logs for debugging. Make sure to use <code>control + c</code> to gracefully shut down the server when you&rsquo;re done with it.</p>

<h3 id="unable-to-load-server-locally">Unable to load server locally</h3>

<p>Sometimes the above command will fail with the message <code>A server is already running.</code> This usually happens when the local server is not shut down gracefully.</p>

<p>To fix this load up the docker container directly in a shell session</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bash
</code></pre>

<p>Now navigate to <code>~/publisher/tmp/pids</code> and delete the file inside using <code>rm</code>.</p>

<p>If this has happened to Publisher it has likely happened to your local versions of other supporting applications, such as Signon and Publishing API. The same instructions can be used to get those working again.</p>

<h3 id="testing">Testing</h3>

<p>The default <code>rake</code> task runs all the tests:</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rake
</code></pre>

<h3 id="state-machine">State machine</h3>

<p>Maps out the transitions between states for the <code>Edition</code> class. These transitions are defined in the <a href="https://github.com/alphagov/publisher/blob/main/app/models/workflow.rb">workflow</a> module.
A diagram of the current state machine can be seen here: <a href="https://github.com/alphagov/publisher/blob/main/docs/state_machines/state_machine_diagram_for_edition.png">state machine diagram</a>.
The diagram can be (re)generated using the <a href="https://github.com/state-machines/state_machines-graphviz">state_machines-graphviz gem</a>, by doing:</p>

<pre lang="sh"><code>govuk-docker run publisher-lite bundle exec rake state_machines:draw CLASS=Edition TARGET=docs
</code></pre>

<p>This will generate a diagram in the <code>docs/state_machines</code> folder.</p>

<h3 id="entity-relationship-diagram">Entity Relationship Diagram</h3>

<p>The <code>rails-erd</code> gem creates an Entity Relationship Diagram for the ActiveRecord models in the database.
Previously generated diagrams can be seen here:</p>

<ul>
<li><a href="https://github.com/alphagov/publisher/blob/main/docs/entity_relationship_diagrams/publisher-erd-inheritance.pdf">ERD (with inheritance)</a></li>
<li><a href="https://github.com/alphagov/publisher/blob/main/docs/entity_relationship_diagrams/publisher-erd.pdf">ERD (without inheritance)</a></li>
</ul>

<p>The diagram can be (re)generated locally using the <a href="https://github.com/voormedia/rails-erd">rails-erd gem</a>, (see <a href="https://voormedia.github.io/rails-erd/">docs</a>) by running the app locally, connecting to the running Docker container, installing graphviz and then running the following in the Docker container:</p>

<p>ERD with inheritance hierarchies included:</p>

<pre lang="sh"><code>bundle exec rake erd attributes=foreign_keys,primary_keys,timestamps,inheritance,content notation=bachman inheritance=true
</code></pre>

<p>ERD without inheritance hierarchies included:</p>

<pre lang="sh"><code>bundle exec rake erd attributes=foreign_keys,primary_keys,timestamps,inheritance,content notation=bachman
</code></pre>

<h3 id="querying-the-database-of-a-deployed-publisher-app">Querying the database of a deployed publisher app</h3>

<p>Publisher stores its data in a PostgreSQL database. You can interact with the database by connecting to one of the Kubernetes pod and using the <a href="https://guides.rubyonrails.org/active_record_querying.html">Rails Console with ActiveRecord</a>, or you can query it directly with SQL commands by following <a href="https://docs.publishing.service.gov.uk/manual/databases.html#open-a-database-commmand-line-session">the instructions detailed in the GOV.UK developer docs</a>.</p>

<h3 id="feature-flags">Feature flags</h3>

<p>For details on how feature flags are managed in Publisher, see the <a href="/repos/publisher/feature-flags.html">feature flags documentation</a>.</p>

<h3 id="adding-promotions-to-completed-transactions">Adding promotions to Completed Transactions</h3>

<p>For instructions on how to add a new type of promotion to Completed Transactions, see the <a href="/repos/publisher/adding-a-promotion-to-a-completed-transaction.html">&ldquo;adding a promotion&rdquo; documentation</a>.</p>

<h2 id="further-documentation">Further documentation</h2>

<ul>
<li><a href="/repos/publisher/fact-checking.html">Fact Checking</a></li>
</ul>

<h2 id="licence">Licence</h2>

<p><a href="https://github.com/alphagov/publisher/blob/main/LICENCE">MIT License</a></p>
<p></div></p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/govuk-developer-docs/blob/main/data/repos.yml">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fpublisher.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
