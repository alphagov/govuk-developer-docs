

<!doctype html>
<html lang="en" class="govuk-template govuk-template--rebranded no-js">
  <head>
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>search-api: Relevancy - GOV.UK Developer Documentation</title>

    <link href="/stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.publishing.service.gov.uk/repos/search-api/relevancy.html">
      <link rel="icon" sizes="48x48" href="/assets/govuk/assets/rebrand/images/favicon.ico">
      <link rel="icon" sizes="any" href="/assets/govuk/assets/rebrand/images/favicon.svg" type="image/svg+xml">
      <link rel="mask-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-mask.svg" color="#0b0c0c">
      <link rel="apple-touch-icon" href="/assets/govuk/assets/rebrand/images/govuk-icon-180.png">
      <link rel="manifest" href="/assets/govuk/assets/rebrand/manifest.json">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.publishing.service.gov.uk" />
      <meta name="twitter:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta name="twitter:title" content="search-api: Relevancy - GOV.UK Developer Documentation" />
      <meta name="twitter:url" content="https://docs.publishing.service.gov.uk/repos/search-api/relevancy.html" />

      <meta property="og:image" content="https://docs.publishing.service.gov.uk/assets/govuk/assets/rebrand/images/govuk-opengraph-image.png" />
      <meta property="og:site_name" content="GOV.UK Developer Documentation" />
      <meta property="og:title" content="search-api: Relevancy" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.publishing.service.gov.uk/repos/search-api/relevancy.html" />

      <script>
  document.addEventListener('DOMContentLoaded', function () {
    var markup = `<div id="global-cookie-message" data-module="cookie-banner" data-nosnippet="" aria-label="Can we store analytics cookies on your device?" class="gem-c-cookie-banner govuk-clearfix govuk-cookie-banner js-banner-wrapper" role="region" hidden="hidden" title="Can we store analytics cookies on your device?"> <div class="govuk-cookie-banner__message govuk-width-container"> <div class="govuk-grid-row"> <div class="govuk-grid-column-two-thirds"> <h2 class="govuk-cookie-banner__heading govuk-heading-m">Can we store analytics cookies on your device?</h2> <div tabindex="-1" class="govuk-cookie-banner__content gem-c-cookie-banner__confirmation"> <div class="gem-c-cookie-banner__content"><p class='govuk-body'>Weâ€™d like to set some cookies to understand how you use this site and remember your settings.</p><p class='govuk-body'>We also use cookies set by other sites to help us deliver content from their services.</p></div> <p class="gem-c-cookie-banner__confirmation-message--accepted govuk-body" hidden data-ga4-cookie-banner data-module="ga4-link-tracker" data-ga4-track-links-only data-ga4-set-indexes data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" >You have accepted additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> <p class="gem-c-cookie-banner__confirmation-message--rejected govuk-body" hidden>You have rejected additional cookies. <span class="gem-c-cookie-banner__confirmation-message">You can <a class="govuk-link" href="/cookies.html">change your cookie settings</a> at any time.</span></p> </div> </div> </div> <div class="js-confirmation-buttons govuk-button-group"> <button class="gem-c-button govuk-button" type="submit" data-accept-cookies="true" data-cookie-types="all">Accept additional cookies</button> <button class="gem-c-button govuk-button" type="submit" data-reject-cookies="true">Reject additional cookies</button> <a class="govuk-link" href="/cookies.html">View cookies</a> </div> <div hidden class="js-hide-button govuk-button-group"> <button class="gem-c-cookie-banner__hide-button govuk-button" data-hide-cookie-banner="true" data-module="ga4-event-tracker" data-ga4-event="{&quot;event_name&quot;:&quot;select_content&quot;,&quot;type&quot;:&quot;cookie banner&quot;,&quot;action&quot;:&quot;closed&quot;,&quot;section&quot;:&quot;You have accepted additional cookies&quot;}" > Hide cookie message </button> </div> </div> </div>`;
    var banner = document.createElement('div');
    banner.innerHTML = markup;
    document.body.prepend(banner);
  })
</script>


  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
        <svg
          focusable="false"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 324 60"
          height="30"
          width="162"
          fill="currentcolor"
          class="govuk-header__logotype"
          aria-label="GOV.UK">
          <title>GOV.UK</title>
          <g>
            <circle cx="20" cy="17.6" r="3.7"></circle>
            <circle cx="10.2" cy="23.5" r="3.7"></circle>
            <circle cx="3.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <circle cx="43.3" cy="17.6" r="3.7"></circle>
            <circle cx="53.2" cy="23.5" r="3.7"></circle>
            <circle cx="59.7" cy="33.2" r="3.7"></circle>
            <circle cx="31.7" cy="30.6" r="3.7"></circle>
            <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
          </g>
          <circle class="govuk-logo-dot" cx="226" cy="36" r="7.3"/>
          <path d="M93.94 41.25c.4 1.81 1.2 3.21 2.21 4.62 1 1.4 2.21 2.41 3.61 3.21s3.21 1.2 5.22 1.2 3.61-.4 4.82-1c1.4-.6 2.41-1.4 3.21-2.41.8-1 1.4-2.01 1.61-3.01s.4-2.01.4-3.01v.14h-10.86v-7.02h20.07v24.08h-8.03v-5.56c-.6.8-1.38 1.61-2.19 2.41-.8.8-1.81 1.2-2.81 1.81-1 .4-2.21.8-3.41 1.2s-2.41.4-3.81.4a18.56 18.56 0 0 1-14.65-6.63c-1.6-2.01-3.01-4.41-3.81-7.02s-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83a20.45 20.45 0 0 1 19.46-13.65c3.21 0 4.01.2 5.82.8 1.81.4 3.61 1.2 5.02 2.01 1.61.8 2.81 2.01 4.01 3.21s2.21 2.61 2.81 4.21l-7.63 4.41c-.4-1-1-1.81-1.61-2.61-.6-.8-1.4-1.4-2.21-2.01-.8-.6-1.81-1-2.81-1.4-1-.4-2.21-.4-3.61-.4-2.01 0-3.81.4-5.22 1.2-1.4.8-2.61 1.81-3.61 3.21s-1.61 2.81-2.21 4.62c-.4 1.81-.6 3.71-.6 5.42s.8 5.22.8 5.22Zm57.8-27.9c3.21 0 6.22.6 8.63 1.81 2.41 1.2 4.82 2.81 6.62 4.82S170.2 24.39 171 27s1.4 5.62 1.4 8.83-.4 6.02-1.4 8.83-2.41 5.02-4.01 7.02-4.01 3.61-6.62 4.82-5.42 1.81-8.63 1.81-6.22-.6-8.63-1.81-4.82-2.81-6.42-4.82-3.21-4.41-4.01-7.02-1.4-5.62-1.4-8.83.4-6.02 1.4-8.83 2.41-5.02 4.01-7.02 4.01-3.61 6.42-4.82 5.42-1.81 8.63-1.81Zm0 36.73c1.81 0 3.61-.4 5.02-1s2.61-1.81 3.61-3.01 1.81-2.81 2.21-4.41c.4-1.81.8-3.61.8-5.62 0-2.21-.2-4.21-.8-6.02s-1.2-3.21-2.21-4.62c-1-1.2-2.21-2.21-3.61-3.01s-3.21-1-5.02-1-3.61.4-5.02 1c-1.4.8-2.61 1.81-3.61 3.01s-1.81 2.81-2.21 4.62c-.4 1.81-.8 3.61-.8 5.62 0 2.41.2 4.21.8 6.02.4 1.81 1.2 3.21 2.21 4.41s2.21 2.21 3.61 3.01c1.4.8 3.21 1 5.02 1Zm36.32 7.96-12.24-44.15h9.83l8.43 32.77h.4l8.23-32.77h9.83L200.3 58.04h-12.24Zm74.14-7.96c2.18 0 3.51-.6 3.51-.6 1.2-.6 2.01-1 2.81-1.81s1.4-1.81 1.81-2.81a13 13 0 0 0 .8-4.01V13.9h8.63v28.15c0 2.41-.4 4.62-1.4 6.62-.8 2.01-2.21 3.61-3.61 5.02s-3.41 2.41-5.62 3.21-4.62 1.2-7.02 1.2-5.02-.4-7.02-1.2c-2.21-.8-4.01-1.81-5.62-3.21s-2.81-3.01-3.61-5.02-1.4-4.21-1.4-6.62V13.9h8.63v26.95c0 1.61.2 3.01.8 4.01.4 1.2 1.2 2.21 2.01 2.81.8.8 1.81 1.4 2.81 1.81 0 0 1.34.6 3.51.6Zm34.22-36.18v18.92l15.65-18.92h10.82l-15.03 17.32 16.03 26.83h-10.21l-11.44-20.21-5.62 6.22v13.99h-8.83V13.9"/>
        </svg>
        <span class="govuk-header__product-name">
          Developer docs
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual/get-started.html">Get started</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/manual.html">Manual</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/kubernetes/">Kubernetes</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="/apps.html" aria-current="page">Apps</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/repos.html">Repos</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/mobile/">Mobile</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/content-schemas.html">Schemas</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="/document-types.html">Document types</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="/">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.publishing.service.gov.uk"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                  <ul>
    <li>
      <a href="/repos/search-api.html" rel="noopener" class="govuk-link">search-api</a>
    </li>
    <li>
      <ul>
            <li><a href="/repos/search-api/adding-new-fields.html" rel="noopener" class="govuk-link">Adding new fields to a document type</a></li>
    <li><a href="/repos/search-api/content-api.html" rel="noopener" class="govuk-link">Internal "content API"</a></li>
    <li><a href="/repos/search-api/documents.html" rel="noopener" class="govuk-link">Documents API (to be deprecated)</a></li>
    <li><a href="/repos/search-api/indexing.html" rel="noopener" class="govuk-link">Indexing</a></li>
    <li><a href="/repos/search-api/new-indexing-process.html" rel="noopener" class="govuk-link">Moving a format to the new indexing process</a></li>
    <li><a href="/repos/search-api/relevancy.html" rel="noopener" class="govuk-link">Relevancy</a></li>
    <li><a href="/repos/search-api/schemas.html" rel="noopener" class="govuk-link">Schema definitions</a></li>
    <li><a href="/repos/search-api/search-quality-metrics.html" rel="noopener" class="govuk-link">Search Quality Metrics</a></li>
    <li><a href="/repos/search-api/using-the-search-api.html" rel="noopener" class="govuk-link">Using the search API</a></li>
    <li class="subdir__heading">arch</li>
    <ul class="subdir__menu">
          <li><a href="/repos/search-api/arch/adr-001-use-of-both-rabbitmq-and-sidekiq-queues.html" rel="noopener" class="govuk-link">Decision record: use of both RabbitMQ (bunny) and Redis (Sidekiq) queuing systems</a></li>
    <li><a href="/repos/search-api/arch/adr-002-handle-race-conditions-in-govuk-index.html" rel="noopener" class="govuk-link">Decision record: use versioning to handle race conditions when updating the govuk index</a></li>
    <li><a href="/repos/search-api/arch/adr-003-popularity-updating-without-index-locks.html" rel="noopener" class="govuk-link">Decision record: perform popularity updating without using an index lock</a></li>
    <li><a href="/repos/search-api/arch/adr-004-transition-mainstream-to-publishing-api-index.html" rel="noopener" class="govuk-link">Decision record: Transition mainstream formats to a Publishing API derived search index</a></li>
    <li><a href="/repos/search-api/arch/adr-005-incremental-popularity-updates.html" rel="noopener" class="govuk-link">Decision record: Incremental popularity updates</a></li>
    <li><a href="/repos/search-api/arch/adr-006-transition-whitehall-to-publishing-api-index.html" rel="noopener" class="govuk-link">Decision record: Transition whitehall documents to a Publishing API derived search index</a></li>
    <li><a href="/repos/search-api/arch/adr-007-batch-processing-of-rabbit-mq-messages.html" rel="noopener" class="govuk-link">Decision record: Batch processing of rabbit MQ messages</a></li>
    <li><a href="/repos/search-api/arch/adr-008-elasticsearch5-upgrade.html" rel="noopener" class="govuk-link">Decision record: Upgrade to Elasticsearch 5</a></li>
    <li><a href="/repos/search-api/arch/adr-009-elasticsearch6-upgrade.html" rel="noopener" class="govuk-link">Decision record: Upgrade to Elasticsearch 6</a></li>
    <li><a href="/repos/search-api/arch/adr-010-learn-to-rank.html" rel="noopener" class="govuk-link">Decision record: Learning To Rank</a></li>
    <li><a href="/repos/search-api/arch/adr-011-sagemaker.html" rel="noopener" class="govuk-link">Decision record: Sagemaker</a></li>
    <li><a href="/repos/search-api/arch/adr-012-learn-to-rank.html" rel="noopener" class="govuk-link">Decision record: Decommissioning Learning to Rank</a></li>
    <li><a href="/repos/search-api/arch/adr-013-rabbitmq-sidekiq-removal.html" rel="noopener" class="govuk-link">Decision record: Removing Sidekiq from RabbitMQ queue consumers</a></li>

    </ul>

      </ul>
    </li>
  </ul>

              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
              
<script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "name": "Home",
        "@id": "http://www.dev.gov.uk/"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "name": "Apps",
        "@id": "http://www.dev.gov.uk/apps.html"
      }
    },
    {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "name": "search-api",
        "@id": "http://www.dev.gov.uk/repos/search-api.html"
      }
    }
  ]
}
</script>

<nav data-module="ga4-link-tracker" aria-label="Breadcrumb" class="gem-c-breadcrumbs govuk-breadcrumbs">
  <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;1&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;2&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/apps.html">Apps</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a data-ga4-link="{&quot;event_name&quot;:&quot;navigation&quot;,&quot;type&quot;:&quot;breadcrumb&quot;,&quot;index_link&quot;:&quot;3&quot;,&quot;index_total&quot;:&quot;3&quot;}" class="govuk-breadcrumbs__link" href="/repos/search-api.html">search-api</a>
        </li>
  </ol>
</nav>
  <div class="govuk-!-font-size-16 govuk-!-margin-top-6">
    <div class="govuk-warning-text">
      <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
      <strong class="govuk-warning-text__text">
        <span class="govuk-warning-text__assistive">Warning</span>
        This document has not been updated for a while now. It may be out of date.
      </strong>
    </div>

  Last updated: <a href="https://github.com/alphagov/search-api/commit/e7512184dc5c71bc282428a8ff8b460438d2e9f1">15 May 2024</a>
</div>

  <h1 class="page-title">search-api: Relevancy</h1>

  
<p>This document explains how relevancy ordering works when performing a
search.</p>
<h2 id="contents">Contents</h2>
<ol>
<li><a href="#what-is-relevancy">What is relevancy?</a></li>
<li><a href="#what-impacts-relevancy">What impacts relevancy?</a></li>
<li>
<a href="#what-impacts-document-retrieval">What impacts document retrieval?</a>
<ol>
<li><a href="#boosting">Boosting</a></li>
<li><a href="#best-and-worst-bets">Best and worst bets</a></li>
<li><a href="#stopwords">Stopwords</a></li>
<li><a href="#synonyms">Synonyms</a></li>
<li><a href="#categorisation-of-fields">Categorisation of fields</a></li>
<li><a href="#analyzers">Analyzers</a></li>
<li><a href="#excluded-formats">Excluded formats</a></li>
</ol>
</li>
<li><a href="#possible-problems-with-queries-and-relevance">Possible problems with queries and relevance</a></li>
<li><a href="#finding-underperforming-queries">Finding underperforming queries</a></li>
</ol>
<h2 id="what-is-relevancy">What is relevancy?</h2>
<p>A list of documents returned by Search API will include an <code>es_score</code> and
a <code>combined_score</code> on every document.</p>
<pre lang="ruby"><code># Response for a search for 'Harry Potter'
[
  { title: "Harry Potter", combined_score: 3 },
  { title: "Harry Kane", combined_score: 2 },
  { title: "Ron Weasley", combined_score: 1 }
]
</code></pre>
<p>The <code>combined_score</code> is used for ranking results and represents how
relevant we think a result is to your query.</p>
<h2 id="what-impacts-document-retrieval">What impacts document retrieval?</h2>
<p>Out of the box, Elasticsearch comes with a decent scoring algorithm.
They have a <a href="https://www.elastic.co/guide/en/elasticsearch/guide/master/scoring-theory.html">guide on scoring relevancy</a> which is worth
reading.</p>
<p>We've done some work in Search API to <a href="https://www.elastic.co/guide/en/elasticsearch/guide/master/relevance-conclusion.html">tune relevancy</a>,
overriding the default Elasticsearch behaviour, which we go into
below.</p>
<p>These following factors are combined into a single <code>es_score</code>. The
top scoring documents will be retrieved for ranking.</p>
<h3 id="boosting">Boosting</h3>
<p>We don't only use the query relevancy score to rank documents, we
apply some additional boosting factors:</p>
<ul>
<li>
<strong>Popularity:</strong> more visited documents are likely to be more useful
to users.</li>
<li>
<strong>Recency:</strong> a more recently updated document is more likely to be
useful than an older document.</li>
<li>
<strong>Properties:</strong> we have domain-specific knowledge about our
content, and can make judgements on what sorts of content are more
likely to be useful to the average user.</li>
</ul>
<h4 id="popularity">Popularity</h4>
<p>This is updated nightly from recent Google Analytics data, gathered by
the <a href="https://github.com/alphagov/search-analytics">search-analytics</a> application.</p>
<p>Here is the initial reasoning for the numbers (<a href="https://github.com/alphagov/search-api/commit/6cbd84f36ff70ce1be6a368e807c72ba09c74f23">6cbd84f</a>, May 2014):</p>
<blockquote>
<p>This field is populated from the page-traffic index, which in turn
is populated from a dump file produced by the python scripts in the
search-analytics repository.</p>
<p>The popularity is currently defined here as 1.0 / the rank of the
page in terms of traffic.  ie, Our highest traffic page gets 1.0,
the next highest gets 0.5, the next highest gets 0.333.  This is a
nice and stable measure.</p>
</blockquote>
<p>If we want to boost the popularity of a query then we do so by 0.001
(<code>POPULARITY_OFFSET = 0.001</code> in <a href="https://github.com/alphagov/search-api/blob/master/lib/search/query_components/popularity.rb">popularity.rb</a>).  It is not clear
where this number came from.</p>
<p>We also boost using <code>boost_mode: :multiply</code> (multiply the <code>_score</code>
with the function result (default)).</p>
<p>We store page traffic data in the <code>page-traffic</code> index.  For each page
we store its rank relative to other pages on GOV.UK in the <code>rank_14</code>
field and its number of page views in the <code>vc_14</code> field.</p>
<h4 id="recency">Recency</h4>
<p>This is an implementation of <a href="https://solr.apache.org/guide/7_7/function-queries.html#recip-function">this curve</a>,
and is applied to documents of the "announcement" type in the <a href="https://github.com/alphagov/search-api/blob/master/lib/search/query_components/booster.rb">booster.rb</a>
file.  It serves to increase the score of new documents and decrease
the score of old documents.</p>
<p>Only documents of <code>search_format_types</code> 'announcement' are affected by
recency boosting.</p>
<p>The curve was chosen so that it only applies the boost temporarily (2
months moderate decay then a rapid decay after that).</p>
<h4 id="properties">Properties</h4>
<p>This is defined by the <a href="https://github.com/alphagov/search-api/blob/master/config/query/boosting.yml">boosting.yml</a> file, and is applied in the
<a href="https://github.com/alphagov/search-api/blob/master/lib/search/query_components/booster.rb">booster.rb</a> file.</p>
<p>For example, if a document has <code>is_historic: true</code> we downrank it, so
it's less likely to appear at the top of search results.</p>
<p>It is unclear where the numbers came from.</p>
<h3 id="best-and-worst-bets">Best and worst bets</h3>
<p>Some search queries have perfect answers.  For example, a search for
"HM Treasury" should have the HM Treasury organisation page as the top
result.</p>
<p>To handle these cases we have a concept called "best bets".</p>
<p>A "best bet" for a search query is a result that should be shoehorned
into the top of the results list for that query.  It's a way of
boosting that is a surefire route to having your document top the
results for a given query.</p>
<p>Best bets are managed with the <a href="https://github.com/alphagov/search-admin">Search Admin</a> application.</p>
<p>Example best bets:</p>
<pre><code>Algeria: /foreign-travel-advice/algeria
Citizenship: /becoming-a-british-citizen
</code></pre>
<p>There's also a concept called "worst bets".  These are useful if our
search results are so bad that we have to manually downrank a result
for a given query.  For example, "vehicle" shouldn't result in
"unicycle" being the top result.</p>
<p>Best and worst bets are implemented in the <a href="https://github.com/alphagov/search-api/blob/master/lib/search/query_components/best_bets.rb">best_bets.rb</a> file.</p>
<h3 id="stopwords">Stopwords</h3>
<p>Stopwords are words like "is", "and", "an", and "a".  They're words we
filter out when processing a search query, since they're so common
they're not useful.  They also enable Elasticsearch to maintain a
smaller index.</p>
<p>The stopwords themselves are provided by Elasticsearch.  There's
nothing in the Search API repo that looks at a list of omitted terms.
This is handled by the default <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html">stop token filter</a>.</p>
<p><strong>History of stopwords</strong></p>
<p>There has been some talk of not including stopwords in the past
(<a href="https://github.com/alphagov/search-api/commit/0fe6e526c78e8b115371855a91d4b39ccb22098a">0fe6e52</a>, May 2015) during this time a <code>no_stop</code> method was
implemented that seems to prevent stopwords from being used.  Again this
seems to be served by Elasticsearch because it's not defined in Search
API.</p>
<p><strong>Potential improvements to stopwords</strong></p>
<p>Given that we're taking a stock list of stopwords from Elasticsearch,
we may be missing out on a chance to edit them in a way that might be
more useful for users. Looking into what words to omit / not omit might
be a useful tuning exercise.</p>
<p>A search with stopwords is different to a search without stopwords:</p>
<ul>
<li>
<p>If you search Search API for stopwords then you get literally
nothing: <a href="http://www.gov.uk/api/search.json?q=the+that+and+if">http://www.gov.uk/api/search.json?q=the+that+and+if</a></p>
</li>
<li>
<p>If you search for nothing then you get the some of the more
frequently clicked links: <a href="http://www.gov.uk/api/search.json?q=">http://www.gov.uk/api/search.json?q=</a></p>
</li>
</ul>
<h3 id="synonyms">Synonyms</h3>
<p>A synonym is a word or phrase that means exactly or nearly the same as
another word or phrase in the same language, for example shut is a
synonym of close.</p>
<p>We use synonyms to show relevant results related to "vehicle tax" regardless
of whether you searched for "car tax" or "auto tax".</p>
<p>Synonyms are defined in the <a href="https://github.com/alphagov/search-api/blob/master/config/schema/synonyms.yml">synonyms.yml</a> file and are applied to
the Elasticsearch index configuration in the <a href="https://github.com/alphagov/search-api/blob/master/lib/schema/schema_config.rb">schema_config.rb</a>
file.</p>
<h4 id="grouping-of-synonyms">Grouping of synonyms</h4>
<p>Each group of synonyms is written in the form:</p>
<pre><code>foo, bar, baz =&gt; bat, qux, quux
</code></pre>
<p>This means that each of the (comma separated) terms on the left of the
<code>=&gt;</code> map to each of the (comma separated) terms on the right.</p>
<p>For example:</p>
<pre><code>leap, hop =&gt; jump
</code></pre>
<p>means "a search for 'leap' or 'hop' should return documents with
'jump' in them.</p>
<p>And:</p>
<pre><code>run, speedwalk =&gt; sprint, gallop
</code></pre>
<p>means "a search for 'run' or 'speedwalk' should return documents with
'sprint' or 'gallop' in them."</p>
<p>It must be applied both at index time and at query time, to ensure that query
terms are mapped to the same single value that exists in the index.</p>
<h3 id="filtering">Filtering</h3>
<p>Additional configuration is defined in the <a href="https://github.com/alphagov/search-api/blob/master/config/schema/elasticsearch_schema.yml">elasticsearch_schema.yml</a> and
<a href="https://github.com/alphagov/search-api/blob/master/config/schema/stems.yml">stems.yml</a> files.  This configuration is merged with the JSON
configuration, and then passed to Elasticsearch directly.</p>
<p><a href="https://opensourceconnections.com/blog/2016/12/02/solr-elasticsearch-synonyms-better-patterns-keyphrases/">This blog post</a> suggests that as well as using
keywords, it can be useful to use "keepwords" to only filter the
phrases we want.</p>
<p>The post suggests to first generate <a href="https://www.elastic.co/blog/searching-with-shingles">shingles</a>, followed by synonyms,
followed by <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-keep-words-tokenfilter.html">keepwords</a>.</p>
<p>In other words: generate candidate keyphrases by shingling, expand
them with synonyms, then cull out any non-synonyms with keepwords.</p>
<h3 id="categorisation-of-fields">Categorisation of fields</h3>
<p>We use parts of a document differently when processing a search query.</p>
<p>We do some categorisation of document fields, to tell Elasticsearch what
we can use them for.</p>
<p>For example <code>date</code> is used for date fields which can be returned and used
for ordering, filtering and aggregating. This lets you filter e.g.
<code>filter_public_timestamp=from:2015-01-01</code>.</p>
<p>There are also fields like <code>acronym</code> which is categorised as a
<code>searchable_text</code> type that Elasticsearch looks at when you submit a keyword
search. So you can search for <code>MOD</code> and get a link to that organisation as
the top result.</p>
<p>These are configured in <a href="https://github.com/alphagov/search-api/blob/master/config/schema/field_types.json"><code>config/schema/field_types.json</code></a> and
<a href="https://github.com/alphagov/search-api/blob/master/config/schema/field_definitions.json"><code>config/schema/field_definitions.json</code></a>.</p>
<h3 id="analyzers">Analyzers</h3>
<p>We have a number of custom analyzers that can be invoked at index time or when querying.</p>
<p>From the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analyzer.html">Elasticsearch documentation</a> on analyzers:</p>
<blockquote>
<p>The values of analyzed string fields are passed through an analyzer
to convert the string into a stream of tokens or terms.  For
instance, the string "The quick Brown Foxes." may, depending on
which analyzer is used, be analyzed to the tokens: quick, brown,
fox.  These are the actual terms that are indexed for the field,
which makes it possible to search efficiently for individual words
within big blobs of text.</p>
</blockquote>
<p>This table describes what each of our analyzers do:</p>
<table>
<thead>
<tr>
<th>Analyzer</th>
<th>Used by main query</th>
<th>Details</th>
<th>Normalize quotes</th>
<th>Strip Quotes</th>
<th>Tokenize</th>
<th>Trim</th>
<th>Lowercase</th>
<th>Asciifolding</th>
<th>Old school synonyms</th>
<th>Remove stop words</th>
<th>Synonyms</th>
<th>Mark protwords (not stemmed)</th>
<th>Stemmer override</th>
<th>Porter2 stemmer</th>
<th>Shingles</th>
<th>ID codes analysis</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>default</code></td>
<td>âœ”</td>
<td>Main analyzer if synonyms are disabled</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ”</td>
<td>None</td>
<td>None</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>searchable_text</code></td>
<td>âœ–</td>
<td>New weighting query uses this for all_searchable_text and FIELD.no_stop</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ–</td>
<td>None</td>
<td>None</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>with_index_synonyms</code></td>
<td>âœ–</td>
<td>New weighting query uses this for FIELD.synonym</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ–</td>
<td>Index synonym list</td>
<td>Synonyms</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>with_search_synonyms</code></td>
<td>âœ–</td>
<td>New weighting query uses this at search time</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ–</td>
<td>Search synonym list</td>
<td>Synonyms</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>exact_match</code></td>
<td>âœ–</td>
<td>Used by best_bet_exact_match_text</td>
<td>âœ”</td>
<td>âœ–</td>
<td>standard</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>best_bet_stemmed_match</code></td>
<td>âœ–</td>
<td>Used for triggering best bets</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>spelling_analyzer</code></td>
<td>âœ–</td>
<td>Used in spelling_text field</td>
<td>âœ”</td>
<td>âœ”</td>
<td>standard</td>
<td>âœ–</td>
<td>âœ”</td>
<td></td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>shingle</td>
<td>âœ–</td>
</tr>
<tr>
<td><code>string_for_sorting</code></td>
<td>âœ–</td>
<td>Used for storing a sortable subfield</td>
<td>âœ”</td>
<td>âœ”</td>
<td>keyword</td>
<td>âœ”</td>
<td>âœ”</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
<td>âœ–</td>
</tr>
</tbody>
</table>
<p>Analyzers are used for different purposes, as the table describes. All of the
analyzers above are used for some purpose.</p>
<p>The main analyzer used at the moment is called <code>with_search_synonyms</code>.
This is the same as the <code>default</code> analyzer, except it also uses synonyms.</p>
<pre lang="yaml"><code># The default analyzer
with_search_synonyms:
  type: custom
  tokenizer: standard
  filter: [standard, asciifolding, lowercase, search_synonym, stop, stemmer_override, stemmer_english]
  char_filter: [normalize_quotes, strip_quotes]
</code></pre>
<p>These are the steps, ignoring asciifolding, which have been added:</p>
<ol>
<li>Normalise and strip quotes</li>
</ol>
<p>The character filters ensure that words with curly apostrophes are normalised
and in some cases removed, for consistent behaviour when searching with
quotes.</p>
<pre lang="ruby"><code>  "It's A Smallâ€™s World" =&gt; ["it", "small", "world"],
  "H'lo â€™Hallo" =&gt; ["h'lo", "h'lo hallo", "hallo"]
</code></pre>
<pre><code>normalize_quotes:
  type: "mapping"
  mappings:
     - "\u0091=&gt;\u0027"
     - "\u0092=&gt;\u0027"
     - "\u2018=&gt;\u0027"
     - "\u2019=&gt;\u0027"
     - "\uFF07=&gt;\u0027"

strip_quotes:
  type: "pattern_replace"
  pattern: "\'"
  replacement: ""
</code></pre>
<ol start="2">
<li>
<p>Split into tokens (tokenizer)</p>
<p>We use the default Elasticsearch tokeniser (<code>tokenizer: standard</code>).</p>
<p>The standard tokeniser uses the unicode text segmentation algorithm.
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-tokenizer.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-tokenizer.html</a></p>
</li>
<li>
<p>Lowercase everything (filter)</p>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenfilter.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lowercase-tokenfilter.html</a></p>
</li>
<li>
<p>Remove stopwords (filter)</p>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html</a></p>
<p>Removes words in the english stopword list</p>
</li>
<li>
<p>Apply our custom stemmer override to each token (filter)</p>
<p>Customises stemming using this list
<a href="https://github.com/alphagov/search-api/blob/master/config/schema/stems.yml">https://github.com/alphagov/search-api/blob/master/config/schema/stems.yml</a></p>
</li>
<li>
<p>Apply the english Stemmer to each token (filter)</p>
<p>The <a href="http://snowball.tartarus.org/algorithms/english/stemmer.html">Porter2 stemming algorithm</a> for english text, an improvement
to the Porter algorithm.
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stemmer-tokenfilter.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stemmer-tokenfilter.html</a></p>
</li>
</ol>
<h3 id="excluded-formats">Excluded formats</h3>
<p>There are some document formats that are not included in search results.
These include smart answers, calculators, licence finders.</p>
<p>We also exclude some paths, such as <code>/random</code>, <code>/homepage</code>, and <code>/humans.txt</code>.</p>
<p>These no-indexed paths and formats are defined in <a href="https://github.com/alphagov/search-api/blob/master/config/govuk_index/migrated_formats.yaml"><code>config/govuk_index/migrated_formats.yaml</code></a>.</p>
<h3 id="debugging-es_score">Debugging es_score</h3>
<p>If you want to understand why a result has a given <code>es_score</code>, you can
use the Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-explain.html">Explain API</a>.  This is exposed by the
Search API.</p>
<p>Please note that <code>es_score</code> is just one feature used by the reranking
model; we don't rank results using <code>es_score</code> alone.</p>
<p>You can see the reasons behind an <code>es_score</code> by including the
<code>debug=explain</code> query parameter in your query.  This will add an
<code>_explanation</code> field to every result, similar to a SQL-like <code>EXPLAIN</code>.</p>
<p>For example, see the explanation produced by <a href="https://www.gov.uk/api/search.json?debug=explain&amp;q=harry%20potter">searching for "harry
potter"</a>.  This shows an example of stemming, where
"harry" becomes "harri".  This is due to the rule "replace suffix 'y'
or 'Y' by 'i' if preceded by a non-vowel which is not the first letter
of the word".  You can also see that text similarity scoring (<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-similarity.html#bm25">BM25</a>
in Elasticsearch 6) works by considering both term frequency and
document frequency.</p>
<p>You can see the query Search API sends to Elasticsearch with the
<code>debug=show_query</code> parameter.  Debug parameters can be combined, like
<code>debug=show_query,explain</code>.  The debug output is verbose, so sometimes
restricting to only a handful of results, with <code>count=0</code> or <code>count=1</code>,
is useful.</p>
<h2 id="possible-problems-with-queries-and-relevance">Possible problems with queries and relevance</h2>
<h3 id="the-way-we-handle-longer-search-terms-is-broken">The way we handle longer search terms is broken</h3>
<p>We use <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-match-query-phrase.html">phrase queries</a> to take phrases into account in search queries.</p>
<p>We're not using the <em><a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/slop.html">slop</a></em> parameter, so the phrase component will
only work where the query uses the exact same phrasing. It's not clear
whether this would be useful, except maybe for names of services/forms/departments.</p>
<p>The <code>slop</code> parameter tells the <code>match_phrase</code> query how far apart terms are
allowed to be while still considering the document a match. By <em>how far
apart</em> we mean <em>how many times do you need to move a term in order to make
the query and document match?</em></p>
<p>Explanation from the Lucene documentation:</p>
<blockquote>
<p>Sets the number of other words permitted between words in query phrase.
If zero, then this is an exact phrase search.</p>
</blockquote>
<blockquote>
<p>The slop is in fact an edit-distance, where the units correspond to moves
of terms in the query phrase out of position. For example, to switch the
order of two words requires two moves (the first move places the words
atop one another), so to permit re-orderings of phrases, the slop must
be at least two.</p>
</blockquote>
<blockquote>
<p>More exact matches are scored higher than sloppier matches, thus
search results are sorted by exactness.</p>
</blockquote>
<p>Essentially, with a <code>slop</code> value of 1, a query for 'harry potter' would
return documents with the phrase 'potter harry' in them.</p>
<p>Although all words need to be present in phrase matching, even when using
slop, the words donâ€™t necessarily need to be in the same sequence in order
to match. With a high enough slop value, words can be arranged in any order.</p>
<p><a href="https://www.elastic.co/blog/searching-with-shingles">Shingles</a> are another way to take phrases into account,
which allow matching n-grams.  This was implemented in the past, but
was broken (<a href="https://github.com/alphagov/search-api/commit/6ece793190932fee31be5437c4c56773dc358ff6">6ece793</a>, May 2015) and the fixed implementation never
went live (<a href="https://github.com/alphagov/search-api/commit/806a68cb11f926c328bf360171c754ed6fca06ac">806a68c</a>, Dec 2017).</p>
<h3 id="there-is-no-boosting-of-individual-field-matches">There is no boosting of individual field matches</h3>
<p>We treat a match in title, description, acronym and indexable content
the same, but these are different things.  A user might expect title
and description matches to be much more important than body content.</p>
<p>We're using field-specific boosts (applied in the <a href="https://github.com/alphagov/search-api/blob/master/lib/search/query_components/core_query.rb">core_query.rb</a>
file) when the query is a quoted phrase, but not for normal searches.</p>
<pre lang="ruby"><code>PHRASE_MATCH_TITLE_BOOST = 5
PHRASE_MATCH_ACRONYM_BOOST = 5
PHRASE_MATCH_DESCRIPTION_BOOST = 2
PHRASE_MATCH_INDEXABLE_CONTENT_BOOST = 1
</code></pre>
<h3 id="popularity-is-the-main-proxy-for-good">Popularity is the main proxy for "good"</h3>
<p>Popularity is one of the biggest factors influencing the weighting.
It's based on the overall page views, so there's a positive feedback
loop where something gets popular, which makes it more visible, which
makes it even more popular.</p>
<p>In the past this has caused problems when we know content is better
but something else still gets high traffic (<a href="https://github.com/alphagov/search-api/commit/03c4bfa0a1a816a57d38b71ac5cb22c3a107c275">03c4bfa</a>, May 2015).</p>
<p>If we had other signals of content quality we might be able to reduce our
dependence on the page views.</p>
<h3 id="finding-underperforming-queries">Finding underperforming queries</h3>
<ol>
<li>Go to the <a href="https://datastudio.google.com/u/0/reporting/1-QjJDH5YkBWhF9qb-WEOuGuGIgNJExds/page/Zaus">datastudio report</a>
</li>
</ol>
<p>The report does not automatically update, so it will display only the data for the dates displayed.</p>
<p>To get new data, rerun the BigQuery queries.</p>
<ol start="2">
<li>Apply the following filters:</li>
</ol>
<ul>
<li><code>click_count &gt;= 100</code></li>
<li><code>median_position &gt;=4</code></li>
</ul>
<p>Underperforming queries are ones with a significant click count and a highish median, i.e. around 4 and above.</p>
<p><img src="https://raw.githubusercontent.com/alphagov/search-api/main/docs/images/datastudio-dash.png" alt="datastudio"></p>
<ol start="3">
<li>Visit the Google Analytics dashboard an underperforming query</li>
</ol>
<p>Once you have identified an underperforming query, head over to the Google Analytics (GA) dashboard to see the clickthrough rates and positions of the search results for that query.</p>
<p>e.g. <a href="https://analytics.google.com/analytics/web/#/report/conversions-ecommerce-product-list-performance/a26179049w50705554p53872948/_u.date00=20191016&amp;_u.date01=20191023&amp;explorer-table.plotKeys=%5B%5D&amp;explorer-table.rowCount=50&amp;explorer-table.secSegmentId=analytics.customDimension71&amp;explorer-table.advFilter=%5B%5B0,%22analytics.productListPosition%22,%22RE%22,%22%5E%5B0-9%5D%7B1,1%7D$%22,0%5D,%5B0,%22analytics.customDimension71%22,%22EQ%22,%22utr%22,0%5D%5D&amp;_r.drilldown=analytics.productListName:Search&amp;explorer-table-dataTable.sortColumnName=analytics.productListCTR&amp;explorer-table-dataTable.sortDescending=true&amp;explorer-segmentExplorer.segmentId=analytics.productListPosition/">GA dashboard</a> for the term "utr".</p>
<p>Use the clickthrough rate of each search result relative to its position to inform your hypotheses.</p>

  <script>
    /*
      Manually trigger the styling of the 'current page' in the sidebar,
      as it does not happen automatically because we are still technically
      in single page mode.
    */
    (function () {
        'use strict'
        /*
          Cannot use `$(document).ready` on next line as jQuery has not loaded
          yet. But we can use jQuery in the callback.
        */
        window.addEventListener('load', function () {
            try {
                new GOVUK.Modules.InPageNavigation().start($("html"));
            }
            catch (error) {
                /* Fail without causing other JS in the page to break */
                console.log("Error calling GOVUK's InPageNavigation module", error);
            }
        })
    }());
</script>


            
          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/alphagov/search-api/blob/main/docs/relevancy.md">View source</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs/issues/new?body=Problem+with+%27%27+%28https%3A%2F%2Fdocs.publishing.service.gov.uk%2Frepos%2Fsearch-api%2Frelevancy.html%29&amp;labels=bug&amp;title=Re%3A+%27%27">Report problem</a></li>
                <li><a href="https://github.com/alphagov/govuk-developer-docs">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <svg focusable="false" role="presentation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 60" height="30" width="32" fill="currentcolor" class="govuk-footer__crown">
    <g>
      <circle cx="20" cy="17.6" r="3.7"></circle>
      <circle cx="10.2" cy="23.5" r="3.7"></circle>
      <circle cx="3.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <circle cx="43.3" cy="17.6" r="3.7"></circle>
      <circle cx="53.2" cy="23.5" r="3.7"></circle>
      <circle cx="59.7" cy="33.2" r="3.7"></circle>
      <circle cx="31.7" cy="30.6" r="3.7"></circle>
      <path d="M33.1,9.8c.2-.1.3-.3.5-.5l4.6,2.4v-6.8l-4.6,1.5c-.1-.2-.3-.3-.5-.5l1.9-5.9h-6.7l1.9,5.9c-.2.1-.3.3-.5.5l-4.6-1.5v6.8l4.6-2.4c.1.2.3.3.5.5l-2.6,8c-.9,2.8,1.2,5.7,4.1,5.7h0c3,0,5.1-2.9,4.1-5.7l-2.6-8ZM37,37.9s-3.4,3.8-4.1,6.1c2.2,0,4.2-.5,6.4-2.8l-.7,8.5c-2-2.8-4.4-4.1-5.7-3.8.1,3.1.5,6.7,5.8,7.2,3.7.3,6.7-1.5,7-3.8.4-2.6-2-4.3-3.7-1.6-1.4-4.5,2.4-6.1,4.9-3.2-1.9-4.5-1.8-7.7,2.4-10.9,3,4,2.6,7.3-1.2,11.1,2.4-1.3,6.2,0,4,4.6-1.2-2.8-3.7-2.2-4.2.2-.3,1.7.7,3.7,3,4.2,1.9.3,4.7-.9,7-5.9-1.3,0-2.4.7-3.9,1.7l2.4-8c.6,2.3,1.4,3.7,2.2,4.5.6-1.6.5-2.8,0-5.3l5,1.8c-2.6,3.6-5.2,8.7-7.3,17.5-7.4-1.1-15.7-1.7-24.5-1.7h0c-8.8,0-17.1.6-24.5,1.7-2.1-8.9-4.7-13.9-7.3-17.5l5-1.8c-.5,2.5-.6,3.7,0,5.3.8-.8,1.6-2.3,2.2-4.5l2.4,8c-1.5-1-2.6-1.7-3.9-1.7,2.3,5,5.2,6.2,7,5.9,2.3-.4,3.3-2.4,3-4.2-.5-2.4-3-3.1-4.2-.2-2.2-4.6,1.6-6,4-4.6-3.7-3.7-4.2-7.1-1.2-11.1,4.2,3.2,4.3,6.4,2.4,10.9,2.5-2.8,6.3-1.3,4.9,3.2-1.8-2.7-4.1-1-3.7,1.6.3,2.3,3.3,4.1,7,3.8,5.4-.5,5.7-4.2,5.8-7.2-1.3-.2-3.7,1-5.7,3.8l-.7-8.5c2.2,2.3,4.2,2.7,6.4,2.8-.7-2.3-4.1-6.1-4.1-6.1h10.6,0Z"></path>
    </g>
  </svg>
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <ul class="govuk-footer__inline-list">
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/accessibility.html">Accessibility</a>
            </li>
            <li class="govuk-footer__inline-list-item">
              <a class="govuk-footer__link" href="/cookies.html">Cookies</a>
            </li>
        </ul>

      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="/javascripts/govuk_frontend.js" type="module"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
